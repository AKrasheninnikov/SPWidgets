(function(d){try{if(!d.pt)d.pt={}}catch(B){d.pt={}}if(d.pt._cache===undefined)d.pt._cache={};d.SPWidgets={};d.SPWidgets.version="20130509071217";d.SPWidgets.defaults={};d.fn.SPMsgHasError=function(){var a=d(this).find("ErrorCode"),c=false;if(!a.length)return d(this).find("faultcode").length?true:false;a.each(function(){if(d(this).text()!=="0x00000000"){c=true;return false}});return c};d.fn.SPGetMsgError=function(){var a=d(this),c="ERROR: Call to Sharepoint Web Services failed.";if(a.find("ErrorCode").length)c+=
"\n"+a.find("ErrorCode:first").text()+": "+a.find("ErrorText").text();else if(a.find("faultcode").length)c+=a.find("faultstring").text()+"\n"+a.find("errorstring").text();else c="";return c};d.SPWidgets.fillTemplate=function(a,c){var g={},f,k,e,b,r;g.response="";g.template=String(d("<div/>").append(a).html());g.tokens=g.template.match(/(\{\{.*?\}\})/g);d.isArray(c)||(c=[c]);if(g.tokens!==null){e=0;for(b=c.length;e<b;e++){r=g.template;f=0;for(k=g.tokens.length;f<k;f++){g.tokens[f]=g.tokens[f].replace(/[\{\{\}\}]/g,
"");r=r.replace("{{"+g.tokens[f]+"}}",c[e][g.tokens[f]])}g.response+=r}}return g.response};d.SPWidgets.parseLookupFieldValue=function(a){var c=[],g=String(a).split(";#"),f=g.length,k,e;if(a===undefined)return c;for(a=0;a<f;a++){k=g[a];a++;e=g[a];if(k||e)c.push({id:k,title:e})}return c};d.SPWidgets.getCamlLogical=function(a){a=d.extend({},{type:"AND",values:[],onEachValue:null},a);var c="<And>",g="</And>",f="",k=0,e=0,b=false;a.type=String(a.type).toUpperCase();if(!d.isArray(a.values))a.values=[a.values];
if(a.type!=="AND"){c="<Or>";g="</Or>"}f=c;k=a.values.length;e=k-1;b=d.isFunction(a.onEachValue);if(k<2)f="";for(c=0;c<k;c++){f+=b?String(a.onEachValue(a.values[c])).toString():String(a.values[c]).toString();if(e-c>1){f+=d.SPWidgets.getCamlLogical(d.extend({},a,{values:a.values.splice(c+1,k-c)}));break}}if(k>1)f+=g;return f};d.SPWidgets.SPGetDateString=function(a,c){function g(k){return k<10?"0"+k:k}c=String(c||"local").toLowerCase();a=a||new Date;var f="";return f=c==="utc"?a.getUTCFullYear()+"-"+
g(a.getUTCMonth()+1)+"-"+g(a.getUTCDate())+"T"+g(a.getUTCHours())+":"+g(a.getUTCMinutes())+":"+g(a.getUTCSeconds())+"Z":a.getFullYear()+"-"+g(a.getMonth()+1)+"-"+g(a.getDate())+"T"+g(a.getHours())+":"+g(a.getMinutes())+":"+g(a.getSeconds())};d.SPWidgets.makeSameHeight=function(a,c){var g=0,f=d(a);f.each(function(){var k=d(this).css("height","");if(g<k.outerHeight(true))g=k.outerHeight(true)});if(g>0){if(c)g+=c;f.height(g)}return a};(function(a){var c={};c.initDone=false;a.SPWidgets.defaults.board=
{list:"",field:"",CAMLQuery:"<Query></Query>",CAMLViewFields:"",fieldFilter:null,optionalLabel:"(none)",template:null,webURL:a().SPServices.SPGetCurrentSite(),onGetListItems:null,onPreUpdate:null,onBoardCreate:null};a.fn.SPShowBoard=function(g){if(!c.initDone){c.initDone=true;c.styleSheet!==""&&a('<style type="text/css">\n\n'+c.styleSheet+"\n\n</style>").prependTo("head")}return this.each(function(){var f=a(this),k=typeof g==="string",e=f.hasClass("hasSPShowBoard"),b=null,r="",u=null;if(e&&!k)return this;
else if(k&&e&&!f.hasClass("loadingSPShowBoard")){r=g.toLowerCase();u=f.data("SPShowBoardOptions");if(r==="refresh")u._getListItems().then(function(){u.showItemsOnBoard({refresh:true})});else if(r==="redraw"){u.statesCntr.find("div.spwidget-board-state").sortable("refresh");a.SPWidgets.makeSameHeight(u.statesCntr.find("div.spwidget-board-state"),20)}return this}if(f.hasClass("loadingSPShowBoard"))return this;b=a.extend({},a.SPWidgets.defaults.board,g,{states:[],statesMap:{},tmpltHeader:"",tmpltState:"",
statesCntr:"",headersCntr:"",listItems:[],initDone:false,formUrls:null,isStateRequired:true,getBoardStates:function(){return a.Deferred(function(h){a().SPServices({operation:"GetList",listName:b.list,cacheXML:true,async:false,webURL:b.webURL,completefunc:function(j,i){var m=a(j.responseXML),l=m.find("Fields Field[StaticName='"+b.field+"']");l.length||(l=m.find("Fields Field[DisplayName='"+b.field+"']"));if(l.attr("Required")==="FALSE")b.isStateRequired=false;switch(l.attr("Type").toLowerCase()){case "choice":if(!b.isStateRequired){b.states.push({type:"choice",
title:b.optionalLabel,name:b.optionalLabel});b.statesMap[""]=b.states[b.states.length-1]}if(b.fieldFilter)b.fieldFilter=b.fieldFilter.split(/\,/);l.find("CHOICES CHOICE").each(function(){var q=a(this).text();if(b.fieldFilter)if(!a.grep(b.fieldFilter,function(p){return p===q}).length)return;b.states.push({type:"choice",title:q,name:q});b.statesMap[q]=b.states[b.states.length-1]});h.resolveWith(b,[j,i]);break;case "lookup":if(!b.fieldFilter)b.fieldFilter="<Query></Query>";a().SPServices({operation:"GetListItems",
listName:l.attr("List"),async:true,cacheXML:true,CAMLQuery:b.fieldFilter,CAMLRowLimit:0,CAMLViewFields:'<ViewFields><FieldRef Name="'+l.attr("ShowField")+'" /></ViewFields>',completefunc:function(q,p){if(p==="error")h.rejectWith(f,["Communications Error!",q,p]);else{var s=a(q.responseXML);if(s.SPMsgHasError())h.rejectWith(f,[s.SPGetMsgError(),q,p]);else{if(!b.isStateRequired){b.states.push({type:"lookup",title:b.optionalLabel,name:""});b.statesMap[""]=b.states[b.states.length-1]}s.SPFilterNode("z:row").each(function(){var n=
a(this),t=n.attr("ows_ID");n=n.attr("ows_"+l.attr("ShowField"));t=t+";#"+n;b.states.push({type:"lookup",title:n,name:t});b.statesMap[t]=b.states[b.states.length-1]});h.resolveWith(b,[q,p])}}}})}}})}).promise()},_getListItems:function(){return a.Deferred(function(h){function j(i){a.isFunction(b.onGetListItems)&&b.onGetListItems.call(f,b.listItems,i);h.resolveWith(f,[b.listItems])}a.isFunction(b.CAMLQuery)?b.CAMLQuery.call(f,function(i){if(a.isArray(i)){b.listItems=i;j(b.CAMLQuery)}},g):a().SPServices({operation:"GetListItems",
listName:b.list,async:true,CAMLQuery:b.CAMLQuery,CAMLRowLimit:0,CAMLViewFields:b.CAMLViewFields,completefunc:function(i,m){if(m==="error")h.rejectWith(f,["Communications Error!",i,m]);else{var l=a(i.responseXML);if(l.SPMsgHasError())h.rejectWith(f,[l.SPGetMsgError(),i,m]);else{b.listItems=l.SPFilterNode("z:row").SPXmlToJson({includeAllAttrs:true});j(l)}}}})}).promise()},getBoardItemDataObject:function(h){var j=null,i,m,l;if(h){h=String(h);i=0;for(m=b.listItems.length;i<m;i++){l=b.listItems[i].ID;
if(a.isFunction(l))l=b.listItems[i].ID();l=String(l);if(h===l){j=b.listItems[i];i=m+m}}}return j},showItemsOnBoard:function(h){function j(v,y){var w="",z=null,A="";if(a.isFunction(b.template)){if(w=b.template.call(f,v,y))w=String(w)}else w=a.SPWidgets.fillTemplate(b.template,t);if(y!==undefined&&w!=="")y.html(w);else if(w!==""){z=v.ID;if(a.isFunction(v.ID))z=v.ID();if(q[s]===undefined)q[s]="";if(b.initDone&&i.refresh)A+=" spwidget-temp";q[s]+='<div class="spwidget-board-state-item ui-state-default ui-corner-all'+
A+'" data-id="'+z+'">'+w+"</div>"}return w}var i=a.extend({},{rows:b.listItems,refresh:false,doBoardInsert:true},h);h=[];var m=[],l=[],q={},p=null,s=null,n=p=null,t=null,x;if(!i.refresh){n=0;for(x=b.states.length;n<x;n++){b.states[n].headerTotalEle.html("0");b.states[n].dataEle.empty()}}n=0;for(x=i.rows.length;n<x;n++){t=i.rows[n];s=t[b.field]||"";p=t.ID;if(a.isFunction(s))s=t[b.field]();if(a.isFunction(p))p=p();if(i.refresh===false){b.initDone&&h.push(t);j(t)}else{p=b.statesCntr.find("div[data-id='"+
p+"']");if(p.length){p.addClass("spwidget-temp");if(p.closest("div.spwidget-board-state").data("boardstate")!==s){p.appendTo(b.statesMap[s].dataEle);l.push(t)}j(t,p)}else{b.initDone&&h.push(t);j(t)}}}if(i.doBoardInsert){for(n in q)q.hasOwnProperty(n)&&q[n]!==""&&b.statesMap[n].dataEle.append(q[n]);b.updBoardHeaders();a.pt.addHoverEffect(f.find(".spwidget-board-state-item"))}b.initDone&&i.refresh&&b.statesCntr.find("div.spwidget-board-state-item").not("div.spwidget-temp").each(function(){m.push(b.getBoardItemDataObject(a(this).data("id")));
a(this).remove()}).end().removeClass("spwidget-temp");if(b.initDone){b.statesCntr.find("div.spwidget-board-state").sortable("refresh").end().disableSelection();a.SPWidgets.makeSameHeight(b.statesCntr.find("div.spwidget-board-state"),20);n=b.getEventObject();if(h.length){n.itemsModified.length=0;n.itemsModified.push(h);f.trigger("spwidget:boarditemadd",[f,a.extend({},n)])}if(m.length){n.itemsModified.length=0;n.itemsModified.push(m);f.trigger("spwidget:boarditemremove",[f,a.extend({},n)])}n.itemsModified.length=
0;n.itemsModified.push.apply(n.itemsModified,h);n.itemsModified.push.apply(n.itemsModified,m);n.itemsModified.push.apply(n.itemsModified,l);n.itemsModified.length&&f.trigger("spwidget:boardchange",[f,n])}return q},updBoardHeaders:function(h){var j;if(!a.extend({},{state:null},h).state){h=0;for(j=b.states.length;h<j;h++)b.states[h].headerTotalEle.html(b.states[h].dataEle.children().length)}},getEventObject:function(h){h||(h=b.statesCntr.find("div.spwidget-board-state-item:first"));h=a(h);h={stateTotals:{},
itemTotal:0,currentState:h.closest("div.spwidget-board-state").data("boardstate"),itemObj:b.getBoardItemDataObject(h.data("id"))||{},itemsModified:[]};var j,i;j=0;for(i=b.states.length;j<i;j++)h.itemTotal+=h.stateTotals[b.states[j].name]=Number(b.states[j].headerTotalEle.text());return h},getListFormUrl:function(h){function j(){a().SPServices({operation:"GetFormCollection",listName:b.list,webURL:b.webURL,cacheXML:true,async:false,completefunc:function(i){a(i.responseXML).find("Form").each(function(){var m=
a(this);b.formUrls[String(m.attr("Type")).toLowerCase()]=b.webURL+"/"+m.attr("Url")})}})}h=String(h).toLowerCase();if(b.formUrls===null){b.formUrls={};j()}return b.formUrls[h]||""}});if(!b.list||!b.field){f.html("<div>SPWidgets:Board [ERROR] Missing required input parameters!</div>");return this}f.addClass("loadingSPShowBoard").data("SPShowBoardOptions",b);b.getBoardStates().then(function(){f.removeClass("loadingSPShowBoard").addClass("hasSPShowBoard");f.html(a(c.htmlTemplate).filter("div.spwidget-board"));
b.tmpltHeader=a("<div/>").append(f.find("div.spwidget-board-headers-cntr div.spwidget-board-state").clone()).html();b.tmpltState=a("<div/>").append(f.find("div.spwidget-board-states-cntr div.spwidget-board-state")).html();b.statesCntr=f.find("div.spwidget-board-states-cntr").addClass("spwidget-states-"+b.states.length).empty();b.headersCntr=f.find("div.spwidget-board-headers-cntr").addClass("spwidget-states-"+b.states.length).empty();a.each(b.states,function(h,j){j.headerEle=a(b.tmpltHeader).appendTo(b.headersCntr).attr("data-boardstate",
j.name).attr("data-boardindex",h).html(j.title);j.dataEle=a(b.tmpltState).appendTo(b.statesCntr).attr("data-boardindex",h).attr("data-boardstate",j.name);j.headerTotalEle=a('<span>&nbsp;[<span class="spwidget-state-item-total">0</span>]</span>').appendTo(j.headerEle).find("span.spwidget-state-item-total")});a(b.headersCntr,b.statesCntr).append('<div style="clear:both;"></div>');f.on("sortreceive sortremove",function(h,j){b.updBoardHeaders();a(j.item).removeClass("ui-state-hover")}).on("sortreceive sortcreate",
function(h,j){var i=b.getEventObject(j.item),m,l;if(h.type==="sortcreate"){a.isFunction(b.onBoardCreate)&&b.onBoardCreate.call(f,i);a(h.target).trigger("spwidget:boardcreate",[f,i])}else{m=a.Deferred();l="";l=a.isFunction(i.itemObj.ID)?i.itemObj.ID():i.itemObj.ID;i.updates=[];i.updatePromise=m.promise();i.updates.push([b.field,i.currentState]);if(a.isFunction(b.onPreUpdate))if(b.onPreUpdate.call(j.item,h,j.item,i)===true)return this;if(!i.updates.length)return this;a().SPServices({operation:"UpdateListItems",
listName:b.list,async:true,ID:l,valuepairs:i.updates,completefunc:function(q,p){if(p==="error")m.rejectWith(f,["Communications Error!",q,p]);else{var s=a(q.responseXML);if(s.SPMsgHasError())m.rejectWith(f,[s.SPGetMsgError(),q,p]);else{a(q.responseXML).SPFilterNode("z:row").SPXmlToJson({includeAllAttrs:true});a(h.target).trigger("spwidget:boardchange",[j.item,i]);m.resolveWith(h.target,[i.itemObj,q])}}}})}}).on("click","a.spwidgets-board-action",function(h){h=a(h.currentTarget);var j=String(h.data("spwidgets_board_action")).toLowerCase(),
i="",m=a.pt.getEscapedUrl(window.location.href);switch(j){case "edit-item":i=b.getListFormUrl("EditForm");break;case "view-item":i=b.getListFormUrl("DisplayForm")}window.location.href=i+"?ID="+h.data("spwidgets_id")+"&Source="+m;return this});if(b.template===null)b.template=a(c.htmlTemplate).filter("div.spwidget-item-template");b._getListItems().then(function(){b.showItemsOnBoard();b.statesCntr.find("div.spwidget-board-state").each(function(){var h=a(this);h.sortable({connectWith:h.siblings(),containment:f,
cursor:"move",tolerance:"pointer",opacity:".80",remove:function(){a.SPWidgets.makeSameHeight(b.statesCntr.find("div.spwidget-board-state"),20)}})});b.statesCntr.disableSelection();b.initDone=true;a.SPWidgets.makeSameHeight(b.statesCntr.find("div.spwidget-board-state"),20)})});return this})};c.styleSheet="/** \n * Stylesheet for the Board widget\n * \n * BUILD: May 09, 2013 - 06:51 PM\n */\ndiv.spwidget-board {\n    width: 100%;\n    position: relative;\n}\n\ndiv.spwidget-board div.spwidget-board-headers,\ndiv.spwidget-board div.spwidget-board-headers-cntr,\ndiv.spwidget-board div.spwidget-board-states-cntr, \ndiv.spwidget-board div.spwidget-board-states {\n    width: 100%;\n}\n\ndiv.spwidget-board div.spwidget-board-state {\n    width: 49%;\n    float: left;\n    margin: .1%;\n    padding: .2%;\n}\n\ndiv.spwidget-board div.spwidget-board-headers-cntr {\n    border: none;\n}\ndiv.spwidget-board div.spwidget-board-headers-cntr div.spwidget-board-state {\n    text-align: center;\n    font-weight: bold;\n    font-size: 1.1em;\n}\ndiv.spwidget-board div.spwidget-board-states div.spwidget-board-state {\n    margin-bottom: 1em;\n    min-height: 5em;\n}\n\ndiv.spwidget-board div.spwidget-board-state div.spwidget-board-state-item {\n    padding: .2em;\n    margin: .5em .2em;\n    font-weight: normal;\n    cursor: move;\n    overflow: auto;\n}\ndiv.spwidget-board div.spwidget-board-state-item div.spwidget-board-item-actions{\n    margin-top: .5em;\n    padding: .2em .5em;\n    width: 25%;\n    overflow: hidden;\n    text-align: center;\n}\ndiv.spwidget-board div.spwidget-board-state-item .spwidget-board-handle {\n    \n}\n\n/* Number of Columns (96 % #columns)\n * Currently support 10 columns. \n */\ndiv.spwidget-board .spwidget-states-3 div.spwidget-board-state {\n    width: 32.4%;\n}\ndiv.spwidget-board .spwidget-states-4 div.spwidget-board-state {\n    width: 24%;\n}\ndiv.spwidget-board .spwidget-states-5 div.spwidget-board-state {\n    width: 19.1%;\n}\ndiv.spwidget-board .spwidget-states-6 div.spwidget-board-state {\n    width: 15.8%;\n}\ndiv.spwidget-board .spwidget-states-7 div.spwidget-board-state {\n    width: 13.4%;\n}\ndiv.spwidget-board .spwidget-states-8 div.spwidget-board-state {\n    width: 11.6%;\n}\ndiv.spwidget-board .spwidget-states-9 div.spwidget-board-state {\n    width: 10.2%;\n}\ndiv.spwidget-board .spwidget-states-10 div.spwidget-board-state {\n    width: 9.1%;\n}\n";
c.htmlTemplate='<div class="spwidget-board">\n    <div class="spwidget-board-headers">\n        <div class="spwidget-board-headers-cntr ui-widget-content ui-corner-all">\n            <div class="spwidget-board-state ui-widget-content ui-corner-all"></div>\n            <div style="clear:both;"></div>\n        </div>\n    </div>\n    <div style="clear:both;"></div>\n    <div class="spwidget-board-states">\n        <div class="spwidget-board-states-cntr">\n            <div class="spwidget-board-state ui-widget-content ui-corner-all"></div>\n            <div style="clear:both;"></div>\n        </div>\n    </div>\n    <div style="clear:both;"></div>\n</div>\n<div class="spwidget-item-template">\n    <div>\n        <div>#{{ID}}: {{Title}}</div>\n        <div class="ui-state-active ui-corner-all spwidget-board-item-actions">\n            <a class="spwidgets-board-action" href="javascript:" title="View Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="view-item"><img src="/_layouts/images/icgen.gif" border="0"/></a>\n            <a class="spwidgets-board-action" href="javascript:" title="Edit Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="edit-item"><img src="/_layouts/images/CMSEditSourceDoc.GIF" border="0"/></a>\n        </div>\n    </div>\n</div>\n'})(jQuery);
(function(a){var c={_islookupFieldCssDone:false};a.SPWidgets.defaults.LookupField={list:"",allowMultiples:true,inputLabel:"",inputPlaceholder:"Type and Pick",readOnly:false,exactMatch:true,uiContainer:null,selectFields:["Title"],filter:"",filterFields:["Title"],template:'<div>{{Title}} <span class="spwidgets-item-remove">[x]</span></div>',listTemplate:"{{Title}}",listHeight:0,onItemAdd:null,onItemRemove:null,onReady:null,msgNoItems:"",maxResults:50,minLength:2,hideInput:true,padDelimeter:false,showSelector:false};
a.fn.SPLookupField=function(g){if(!c._islookupFieldCssDone){c._islookupFieldCssDone=true;a('<style type="text/css">\n\n'+c.styleSheet+"\n\n</style>").prependTo("head")}var f=arguments;this.each(function(){var k=a(this);if(!k.is("input")&&!k.is("textarea")||k.hasClass("hasLookupSPField")){if(typeof g==="string"&&k.is("input")){var e=k.data("SPWidgetLookupFieldUI").data("SPWidgetLookupFieldOpt");if(g.toLowerCase()==="method"){k=String(f[1]||"").toLowerCase();var b=f[2]||{};if(k==="clear")if(b.id===
undefined){e._cntr.find("div.spwidgets-lookup-selected").css("display","none").empty();e._ele.val("");e._cntr.find("div.spwidgets-lookup-input").css("display","")}else alert("TBD... Delete individual ID's")}}return this}e=a.extend({},a.SPWidgets.defaults.LookupField,g,{_ele:k.css("display","none").addClass("hasLookupSPField")});e.showSelectedItems=function(h,j){var i=e._selectedItemsCntr.css("display",""),m=[],l=false;if(!i.find("div.spwidgets-item").length||e.allowMultiples===false)i.empty();if(a.isArray(h))m=
h;else m.push(h);a.each(m,function(q,p){if(!i.find("div.spwidgets-item-id-"+p.ID).length){var s=a('<div class="spwidgets-item spwidgets-item-id-'+p.ID+'" data-spid="'+p.ID+'" style="display:none">'+a.SPWidgets.fillTemplate(e.template,p)+"</div>").find(".spwidgets-item-remove").on("click.SPWidgets",function(){c.removeItem(e,this)}).end().appendTo(i);a.isFunction(e.onItemAdd)&&e.onItemAdd.call(e._ele,s,p,e._cntr);if(i.find("div.spwidgets-item-id-"+p.ID).length>0){l=true;s.fadeIn("slow").promise().then(function(){a(this).css("display",
"")});j!==true&&e.storeItemIDs(p.ID,e.allowMultiples);e.allowMultiples===false&&e.hideInput===true&&e._lookupInputEleCntr.css("display","none")}}});l&&e._ele.trigger("change")};e.storeItemIDs=function(h,j){var i=a.trim(e._ele.val()),m=false;a.isArray(h)||(h=[h]);if(j!==true)i="";a.each(h,function(l,q){if(q){if(i.length<1&&e.padDelimeter===true&&!m){i+=";#";m=true}if(i.length>0)i+=";#";i+=q+";#"}});e._ele.val(i)};e._cntr=a(c.htmlTemplate).find(".spwidgets-lookup-cntr").clone(1);e._selectedItemsCntr=
e._cntr.find("div.spwidgets-lookup-selected");e._lookupInputEleCntr=e._cntr.find("div.spwidgets-lookup-input");e._cntr.data("SPWidgetLookupFieldOpt",e);e._ele.data("SPWidgetLookupFieldUI",e._cntr);e.uiContainer===null?e._cntr.insertAfter(e._ele):e._cntr.appendTo(a(e.uiContainer));if(e.showSelector){var r=e._cntr.find("div.ptLookupSPFieldSelectorCntr");e._cntr.find(".ptLookupSPFieldSelector").on("click",function(){r.is(":visible")?r.css("display","none"):r.css("display","block")})}else e._cntr.find(".ptLookupSPFieldSelectorCntr,.ptLookupSPFieldSelector").remove();
e.inputLabel?e._cntr.find("div.spwidgets-lookup-input label").empty().append(e.inputLabel):e._cntr.find("div.spwidgets-lookup-input label").remove();e.inputPlaceholder&&e._lookupInputEleCntr.find("input").attr("placeholder",e.inputPlaceholder);if(e.readOnly===true){e._lookupInputEleCntr.css("display","none");e._cntr.find("div.spwidget-lookup").addClass("spwidget-lookup-readyonly")}e._selectFields="";a.each(e.selectFields,function(h,j){e._selectFields+="<FieldRef Name='"+j+"'/>"});e._templateTokens=
String(e.template).match(/(\$\{.*?\})/g);if(e._templateTokens==null)e._templateTokens=[];a.each(e._templateTokens,function(h,j){e._templateTokens[h]=j.replace(/[\$\{\}]/g,"")});var u={};e._cntr.find("div.spwidgets-lookup-input input").autocomplete({minLength:2,appendTo:e._cntr,open:function(){a(this).autocomplete("widget").each(function(){e.listHeight>0&&a(this).css("height",e.listHeight+"px");return false})},source:function(h,j){h.term=a.trim(h.term);var i=String(a.trim(h.term)).toUpperCase();if(i in
u)j(u[i]);else{u[i]=[];var m=[],l=String(h.term);if(l.match(/\D/)===null&&l.match(/\d/)!==null)m.push("<Eq><FieldRef Name='ID'/><Value Type='Counter'>"+l+"</Value></Eq>");else{l=[h.term];e.exactMatch||(l=String(h.term).split(/ /));for(var q=0,p=e.filterFields.length;q<p;q++){for(var s=[],n=0,t=l.length;n<t;n++)/^(of|and|a|an|to|by|the|or)$/i.test(l[n])||s.push("<Contains><FieldRef Name='"+e.filterFields[q]+"'/><Value Type='Text'>"+l[n]+"</Value></Contains>");m.push(a.SPWidgets.getCamlLogical({values:s,
type:"AND"}))}}m=a.SPWidgets.getCamlLogical({values:m,type:"OR"});if(e.filter)m=a.SPWidgets.getCamlLogical({values:[m,e.filter],type:"AND"});a().SPServices({operation:"GetListItems",listName:e.list,async:true,CAMLQuery:"<Query><Where>"+m+"</Where></Query>",CAMLRowLimit:e.maxResults,CAMLViewFields:"<ViewFields>"+e._selectFields+"</ViewFields>",completefunc:function(x){a(x.responseXML).SPFilterNode("z:row").each(function(){var v=a(this).SPXmlToJson({includeAllAttrs:true})[0];v.value="";v.label=a.SPWidgets.fillTemplate(e.listTemplate,
v);u[i].push(v)});j(u[i])}})}},select:function(h,j){e.showSelectedItems(j.item)}}).on("keyup.SPWidgets",function(h){if(h.which==13){var j=a(h.target).val();j&&String(j).length<e.minLength&&a(h.target).autocomplete("search",j+"    ")}});k=a.SPWidgets.parseLookupFieldValue(e._ele.val());if(k.length)a().SPServices({operation:"GetListItems",async:true,listName:e.list,CAMLQuery:"<Query><Where>"+a.SPWidgets.getCamlLogical({type:"OR",values:k,onEachValue:function(h){var j="";if(h.id)j="<Eq><FieldRef Name='ID'/><Value Type='Counter'>"+
h.id+"</Value></Eq>";return j}})+"</Where></Query>",CAMLViewFields:"<ViewFields>"+e._selectFields+"</ViewFields>",CAMLRowLimit:0,completefunc:function(h){h=a(h.responseXML).SPFilterNode("z:row").SPXmlToJson({includeAllAttrs:true,removeOws:true});e.showSelectedItems(h,true);e.readOnly&&e._cntr.find(".spwidgets-item-remove").remove();a.isFunction(e.onReady)&&e.onReady.call(e._ele,e._cntr);return this}});else a.isFunction(e.onReady)&&e.onReady.call(e._ele,e._cntr);return this});return this};c.removeItem=
function(g,f){var k=a(f).closest("div.spwidgets-item"),e=k.closest("div.spwidgets-lookup-selected"),b=k.data("spid"),r=a.SPWidgets.parseLookupFieldValue(g._ele.val()),u=[],h=0,j=0;k.fadeOut("fast").promise().then(function(){k.remove();if(!g.msgNoItems&&(g.allowMultiples===false||g.allowMultiples===true&&e.find("div.spwidgets-item").length<1))e.css("display","none");g.allowMultiples===false&&g.hideInput===true&&g._lookupInputEleCntr.css("display","");e.find("div.spwidgets-item").length<1&&g.msgNoItems&&
e.append("<div>"+g.msgNoItems+"</div>")});h=0;for(j=r.length;h<j;h++)r[h].id!=b&&u.push(r[h].id);g.storeItemIDs(u);g._lookupInputEleCntr.find("input").focus();return c};c.styleSheet='/**\n * Stylesheet for the Lookup Field widget.\n * \n */\n\n.spwidgets-lookup-cntr {\n    position: relative;\n    display: inline-block;\n    zoom: 1; /* IE7 hack */\n    *display: inline; /* IE7 hack */\n}\n\n\n.spwidgets-lookup-cntr .spwidgets-lookup-selected {\n    -moz-appearance: textfield;\n    -webkit-appearance: textfield;\n    background-color: white;\n    background-color: -moz-field;\n    border: 1px solid  darkgray;\n    box-shadow: 1px 1px 1px 0 lightgray inset;  \n    font: -moz-field;\n    font: -webkit-small-control;\n    margin-top: 5px;\n    padding: 2px 5px; \n}\n\n.spwidgets-lookup-cntr  .spwidgets-lookup-selected .spwidgets-item {\n    display: inline-block;\n    margin-left: .5em;\n}\n.spwidgets-lookup-cntr .spwidgets-item:first-child {\n    margin-left: 0px;\n}\n.spwidgets-lookup-cntr .spwidgets-item-remove {\n    color: red;\n    cursor: pointer;\n}\n\n.spwidgets-lookup-cntr .spwidgets-lookup-input {\n    margin: .2em 0em;\n    position: relative;\n}\n.spwidgets-lookup-cntr .ptLookupSPFieldSelector {\n    height: 16px;\n    width: 16px;\n    text-indent: -99999px;\n    background-repeat: no-repeat;\n    background-image: url("/_layouts/images/ARRDOWNI.GIF");\n    display: inline-block;\n}\n.spwidgets-lookup-cntr .ptLookupSPFieldSelectorCntr {\n    display: none;\n    position: absolute;\n    height: 150px;\n    width: 98%;\n    left: 0px;\n    overflow: auto;\n    z-index: 2000;\n}\n.spwidgets-lookup-cntr ul.ui-autocomplete {\n    overflow: auto;\n}\n\n/* Ready only display */\n.spwidgets-lookup-cntr div.spwidget-lookup-readyonly .spwidgets-lookup-selected {\n    -moz-appearance: none;\n    -webkit-appearance: none;\n    background-color: transparent;\n    border: none;\n    box-shadow: none;\n    font: inherit;\n}\n.spwidgets-lookup-cntr div.spwidget-lookup-readyonly .spwidgets-item-remove {\n    display: none;\n}\n';
c.htmlTemplate='<div>\n    <div class="spwidgets-lookup-cntr">\n        <div class="spwidget-lookup">\n            <div class="spwidgets-lookup-selected" style="display:none;">\n            </div>\n            <div class="spwidgets-lookup-input">\n                <label>Add</label>\n                <input type="text" name="ptLookupSPFieldAdd" value="" />\n                <span class="ptLookupSPFieldSelector">Select</span>\n                <div class="ptLookupSPFieldSelectorCntr ui-widget-content">\n                    <div style="height: 1000px;"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n'})(jQuery);
d.pt.pickSPUser={_isPickSPUserCssDone:false};d.fn.pickSPUser=function(a){if(!d.pt.pickSPUser._isPickSPUserCssDone){d.pt.pickSPUser._isPickSPUserCssDone=true;d('<style type="text/css">\n\n'+d.pt.pickSPUser.styleSheet+"\n\n</style>").prependTo("head")}var c=arguments;this.each(function(){var g=d(this);if(!g.is("input")||g.hasClass("hasPickSPUser"))return typeof a==="string"&&g.is("input")?d.pt.pickSPUser.handleAction.apply(this,c):this;var f=d.extend({},{allowMultiples:true,maxSearchResults:50,onPickUser:null},
a,{eleUserInput:g.css("display","none").addClass("hasPickSPUser")});f.maxSearchResults=parseInt(f.maxSearchResults)||50;var k=d(d.pt.pickSPUser.htmlTemplate).find(".pt-pickSPUser").clone(1).insertAfter(g);f.eleSelected=k.find("div.pt-pickSPUser-selected").empty();f.elePickInput=k.find("div.pt-pickSPUser-input");f.allowMultiples===true&&f.eleSelected.addClass("pt-pickSPUser-selected-multiple");if(g.val()){for(var e=(new String(g.val())).split(";#"),b=e.length,r=0;r<b;r++){var u=e[r];r++;f.eleSelected.append(d.pt.pickSPUser.getUserHtmlElement(f,
u,e[r]))}d.pt.addHoverEffect(f.eleSelected.find("div.pt-pickSPUser-person-cntr"));f.allowMultiples===false&&f.elePickInput.css("display","none")}var h={};f.elePickInput.find("input[name='pickSPUserInputField']").autocomplete({minLength:3,source:function(j,i){if(j.term in h)i(h[j.term]);else{h[j.term]=[];d().SPServices({operation:"SearchPrincipals",searchText:j.term,maxResults:f.maxSearchResults,async:true,completefunc:function(m){d(m.responseXML).find("PrincipalInfo").each(function(){var l=d(this);
h[j.term].push({displayName:l.find("DisplayName").text(),accountId:l.find("UserInfoID").text(),accountName:l.find("AccountName").text(),accountType:l.find("PrincipalType").text(),value:l.find("DisplayName").text(),label:l.find("DisplayName").text()})});i(h[j.term])}})}},select:function(j,i){f.allowMultiples===false&&f.eleSelected.empty();f.eleSelected.append(d.pt.pickSPUser.getUserHtmlElement(f,i.item.accountId,i.item.displayName));d.pt.pickSPUser.storeListOfUsers(k);d.pt.addHoverEffect(k.find("div.pt-pickSPUser-person-cntr"));
setTimeout(function(){j.target.value=""},50);f.allowMultiples===false&&f.elePickInput.hide();d.isFunction(f.onPickUser)&&f.onPickUser.call(f.eleUserInput,d.extend({},i.item))}});k.data("pickSPUserContainerOpt",f);g.data("pickSPUserContainer",k);return this});return this};d.pt.pickSPUser.getUserHtmlElement=function(a,c,g){a=d(d.pt.pickSPUser.htmlTemplate).find(".pt-pickSPUser-person").clone(1);a.attr("data-pickSPUserID",c);a.find("span.pt-person-name").append(g).end().attr("data-pickSPUserNAME",g);
return a};d.pt.pickSPUser.removeUser=function(a){var c=d(a).closest("div.pt-pickSPUser"),g=c.data("pickSPUserContainerOpt");d(a).closest("div.pt-pickSPUser-person").fadeOut("fast",function(){d(this).remove();d.pt.pickSPUser.storeListOfUsers(c)});g.allowMultiples===false&&g.elePickInput.show("fast",function(){g.elePickInput.find("input").focus()})};d.pt.pickSPUser.storeListOfUsers=function(a){a=d(a).closest("div.pt-pickSPUser");var c=a.data("pickSPUserContainerOpt"),g="",f={};a.find("div.pt-pickSPUser-selected div.pt-pickSPUser-person").each(function(){if(!f[d(this).attr("data-pickSPUserID")]){f[d(this).attr("data-pickSPUserID")]=
true;if(g)g+=";#";g+=d(this).attr("data-pickSPUserID");g+=";#";g+=d(this).attr("data-pickSPUserNAME")}});c.eleUserInput.val(g)};d.pt.pickSPUser.handleAction=function(a,c){a=String(a).toLowerCase();c=String(c).toLowerCase();o=d(this).data("pickSPUserContainer").data("pickSPUserContainerOpt");if(a==="method"){if(c==="clear"){o.eleUserInput.val("");o.eleSelected.empty();if(o.allowMultiples===false){o.eleSelected.css("display","none");o.elePickInput.show()}}c==="destroy"&&d(this).hasClass("hasPickSPUser")&&
d(this).removeClass("hasPickSPUser").next(".pt-pickSPUser").remove().show().trigger("change")}return this};d.pt.pickSPUser.styleSheet="/**\n * Styles for the Pick User Widget\n */\n.pt-pickSPUser .pt-pickSPUser-selected-multiple {\n    min-height: 3em;\n}\n\n.pt-pickSPUser .pt-pickSPUser-selected .pt-pickSPUser-person {\n    float: left;\n    margin-left: .2em;\n}\n.pt-pickSPUser .pt-pickSPUser-hint {\n    font-size: .9em;\n}\n\n\n.pt-pickSPUser .pt-pickSPUser-person-cntr {\n    margin: .2em 0em;\n    padding: .2em;\n    position: relative;\n}\n\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-person-name {\n    padding-right: 2em;\n}\n\n/* Item action container (delete button) */\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions {\n    position: absolute;\n    right: 1px;\n    top: 1px;\n    padding: .2em;\n    display: none;\n}\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions .pt-pickSPUser-person-action-links,\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions .pt-pickSPUser-person-action-links .tt-confirm-delete {\n    float:right;\n}\n\n/* Make the action visible if we hover or we are trying to confirm a deletion */\n.pt-pickSPUser .pt-pickSPUser-person-cntr.ui-state-hover .pt-pickSPUser-person-actions,\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions.tt-confirm,\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions a {\n    display:block;\n    float: right;\n}\n\n/* autocomplete busy image */\n.ui-autocomplete-loading {\n    background: white url('/_layouts/images/loading.gif') right center no-repeat;\n}\n\n\n";
d.pt.pickSPUser.htmlTemplate='<!--\n    Html Templates for the PickSPUser plugin.\n    \n    |\n    |   $Author$\n    | $Revision$\n    |     $Date$\n    |       $Id$\n    |\n--\>\n<div>\n    <div class="pt-pickSPUser">\n        <div class="pt-pickSPUser-selected">\n            None Selected!\n        </div>\n        <div style="clear:both"></div>\n        <div class="pt-pickSPUser-input" \n                title="Type user name above to view search results.">\n            <input name="pickSPUserInputField" value="" />\n        </div>\n    </div>\n    \n    <div class="pt-pickSPUser-person">\n        <div class="pt-pickSPUser-person-cntr ui-state-default ui-corner-all">\n            <span class="pt-person-name"></span>\n            <div class="pt-pickSPUser-person-actions">\n                <div class="tt-record-item-action-links">\n                    <a class="tt-delete-icon" href="javascript:" onclick="jQuery.pt.pickSPUser.removeUser(this);">\n                        <img style="border: medium none; margin-right: 2px;" alt="Delete" src="/_layouts/images/delitem.gif">\n                    </a>\n                    <div style="clear:both;"></div>\n                </div>\n                <div style="clear:both;"></div>\n            </div>\n        </div>\n    </div>\n</div>\n';
d.pt.addHoverEffect=function(a){return d(a).each(function(){if(!d(this).hasClass("addHoverEffectDone")){d(this).addClass("addHoverEffectDone");var c=this;d(c).mouseenter(function(){d(c).toggleClass("ui-state-hover")});d(c).mouseleave(function(){d(c).toggleClass("ui-state-hover")})}})};d.pt._isSPUploadCssDone=false;d.fn.SPControlUpload=function(a){var c=d.extend({},{listName:"",folderPath:"",uploadDonePage:"/_layouts/viewlsts.aspx",onPageChange:null,uploadUrlOpt:"",overwrite:false,uploadPage:"/_layouts/Upload.aspx",
overlayClass:"",overlayBgColor:"white",overlayMessage:'<div class="loadingOverlayMsg">Loading...</div>'},a);if(!d.pt._isSPUploadCssDone){d.pt._isSPUploadCssDone=true;d('<style type="text/css">\n\n'+d.pt.SPUploadStyleSheet+"\n\n</style>").prependTo("head")}if(c.listName&&c.listName.indexOf("{")!=0)c.listName=d.pt.getListUID(c.listName);if(!c.listName){d(this).html('<div class="ui-state-error">Input parameter [listName] not valid!</div>');return this}c.siteUrl=d().SPServices.SPGetCurrentSite();if(String(c.uploadPage).toLowerCase().indexOf("http")==
-1){a="/";if(c.uploadPage.indexOf("/")==0)a="";c.uploadPage=c.siteUrl+a+c.uploadPage}if(String(c.uploadDonePage).toLowerCase().indexOf("http")==-1){a="/";if(c.uploadDonePage.indexOf("/")==0)a="";c.uploadDonePage=c.siteUrl+a+c.uploadDonePage}c.uploadPage=c.uploadPage+"?List="+d.pt.getEscapedUrl(c.listName)+"&RootFolder="+d.pt.getEscapedUrl(c.folderPath)+"&Source="+d.pt.getEscapedUrl(c.uploadDonePage)+"&"+c.uploadUrlOpt;c._lastError="";c._reloadCount=0;c.ev={state:1,action:"uploading",hideOverlay:true,
pageUrl:"",page:null,isUploadDone:false};var g="";if(c.overlayBgColor)g="style='background-color:"+c.overlayBgColor+";' ";d(this).each(function(){var f=d(this),k=f.outerHeight()-75,e={top:0,left:0,height:f.outerHeight(true)-15,display:"block"};f.empty().addClass("hasSPControlUploadUI").append("<div class='SPControlUploadUI spcontrolupload'><div class='mainContainer'><div class='iFrameWindow'><iframe name='SPControlUploadUI' frameborder='0' scrollbars='yes' scrolling='yes'></iframe></div><div class='buttonPane'><button type='button' class='ui-state-default' name='upload_button' value='upload' onclick='$.pt._onUpload(this);'>Upload</button></div><div class='loadingOverlay "+
c.overlayClass+"' "+g+"></div></div></div>").find(".SPControlUploadUI").data("SPControlUploadOptions",c).end().find("iframe").css("height",k).load(function(){d.pt._onIFramePageChange(f.find(".SPControlUploadUI"))}).attr("src",c.uploadPage).end().find(".loadingOverlay").append(c.overlayMessage).css(e);return this});return this};d.pt._onUpload=function(a){var c=d(a).closest(".SPControlUploadUI"),g=c.find("iframe").contents(),f=g.find("input[type='file']").closest("tr").siblings().find("span");a=c.data("SPControlUploadOptions");
var k=a.ev;f.css("display","none");if(g.find("input[type='file']").val()){k.state=2;k.action="preLoad";if(a.onPageChange)if(a.onPageChange.call(c.closest(".hasSPControlUploadUI"),k)===false)return false;c.find(".buttonPane").css("display","none").end().find(".loadingOverlay").fadeIn("slow",function(){g.find("input[type='button'][id$='btnOK']").click();if(f.is(":visible")){c.find(".loadingOverlay").css("display","none").end().find(".buttonPane").show(0).end();return false}})}};d.pt._onIFramePageChange=
function(a){var c=d(a).closest(".SPControlUploadUI"),g=c.find("iframe").contents(),f=c.data("SPControlUploadOptions"),k=f.ev;k.pageUrl=g[0].location.href;k.page=g;setTimeout(function(){if(d.pt.isSameUrlpage(d.pt.getUnEscapedUrl(k.pageUrl),d.pt.getUnEscapedUrl(f.uploadPage))){g.find("form").children(":visible").hide();g.find("form").append("<div id='SPControlUploadModUI' style='position:absolute;width:99.9%;height:99.9%x;left:0px;top:0px;background-color:white;padding-top:3em;'></div>");if(RegExp(/error/i).test(d.trim(g.find(".ms-pagetitle").text()))||
RegExp(/error/i).test(d.trim(g.find("title").text()))||RegExp(/error\.aspx/i).test(d.trim(g.find("form").attr("action")))){f._lastError=g.find("[id$='LabelMessage']").text();if(f._reloadCount>1){alert("Error encountered during upload which is causing program to loop. Last upload error was: "+f._lastError);c.find(".loadingOverlay").fadeOut();return}f._reloadCount+=1;c.find("iframe").attr("src",f.uploadPage);return}else{if(g.find("#GearPage")&&!g.find("input[type='file']").length)return;g.find("input[type='file']").closest("table").appendTo(g.find("#SPControlUploadModUI")).removeClass("ms-authoringcontrols").find("a[id$='UploadMultipleLink']").closest("tr").css("display",
"none").end().end().find("input[type='checkbox'][name$='OverwriteSingle']").closest("tr").css("display","none").end().end().find(".ms-fileinput").css("font-size","13pt");if(f._lastError){g.find("input[type='file']").after('<div style="color:red;"><div class="ui-state-error">ERROR: '+f._lastError+"</div></div>");f._lastError=""}f._reloadCount=0;f.overwrite?g.find("input[type='checkbox'][name$='OverwriteSingle']").prop("checked","checked"):g.find("input[type='checkbox'][name$='OverwriteSingle']").prop("checked",
"");c.find(".buttonPane").show();k.state=1;k.action="postLoad";k.hideOverlay=true}}else{k.state=3;k.action="postLoad";k.hideOverlay=true;var e=g.find("form").eq(0),b=e.prop("onsubmit");if(d.pt.isSameUrlpage(k.pageUrl,f.uploadDonePage)){k.isUploadDone=true;k.hideOverlay=false;c.find(".loadingOverlay").empty().append('<div class="ui-state-highlight" style="width:80%;">Upload Complete!</div>')}e[0].onsubmit=function(){c.find(".loadingOverlay").css("display","block");var r=true;if(d.isFunction(f.onPageChange))r=
f.onPageChange.call(c.closest(".hasSPControlUploadUI"),d.extend({},k,{state:3,action:"preLoad"}));if(r===false){c.find(".loadingOverlay").fadeOut();return r}if(d.isFunction(b))r=b();if(r===false){c.find(".loadingOverlay").fadeOut();return r}return r};d(c.find("iframe")[0].contentWindow).unload(function(){c.find(".loadingOverlay").css("display","block");if(d.isFunction(f.onPageChange))return f.onPageChange.call(c.closest(".hasSPControlUploadUI"),d.extend({},k,{state:3,action:"preLoad"}))})}f.onPageChange&&
f.onPageChange.call(c.closest(".hasSPControlUploadUI"),k);if(k.action.toLowerCase()!="postload"||k.hideOverlay==true)c.find(".loadingOverlay").fadeOut()},500)};d.pt.isSameUrlpage=function(a,c){if(!a||!c)return false;var g=a;if(a.indexOf("?")>-1)g=a.substring(0,a.indexOf("?"));return c.indexOf(g)==0?true:false};d.pt.getEscapedUrl=escapeProperly;d.pt.getUnEscapedUrl=unescapeProperly;d.pt.getListUID=function(a){if(!a)return"";var c="";if(d.pt._cache["getListUID:"+a])return c=d.pt._cache["getListUID:"+
a];d().SPServices({operation:"GetList",listName:a,async:false,completefunc:function(g){c=d(g.responseXML).find("List").attr("ID")}});if(c)d.pt._cache["getListUID:"+a]=c;return c};d.pt.SPUploadStyleSheet="/**\n * FILE: jquery.SPControlUpload.css\n * \n * \n */\n.spcontrolupload .mainContainer {\n\tposition: relative;\n\tdisplay:block;\n}\n.spcontrolupload iframe {\n\toverflow: auto;\n\twidth: 99%;\n\theight: 99%;\n}\n.spcontrolupload iframe .ms-fileinput {\n\tfont-size:14pt;\n}\n\n.spcontrolupload .buttonPane {\n\tdisplay: none;\n}\n.spcontrolupload button {\n\tpadding: .5em;\n\tmargin: .2em;\n}\n.spcontrolupload .loadingOverlay {\n\tposition: absolute;\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: none;\n}\n.spcontrolupload .loadingOverlayMsg {\n\tmargin: auto;\n\tpadding: 5em;\n\tfont-size: 1.2em;\n}\n\n"})(jQuery);
