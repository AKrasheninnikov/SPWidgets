(function(f){(function(){try{if(!f.pt)f.pt={}}catch(a){f.pt={}}if(f.pt._cache===undefined)f.pt._cache={};f.SPWidgets={};f.SPWidgets.version="20130623052801";f.SPWidgets.defaults={};f.fn.SPMsgHasError=function(){var c=f(this).find("ErrorCode"),i=false;if(!c.length)return f(this).find("faultcode").length?true:false;c.each(function(){if(f(this).text()!=="0x00000000"){i=true;return false}});return i};f.fn.SPGetMsgError=function(){var c=f(this),i="",d=c.find("ErrorCode"),j=0;d.length||(d=c.find("faultcode"));
if(!d.length)return"";d.each(function(){var e=f(this);if(e.text()!=="0x00000000"){j+=1;i+="("+j+") "+e.text()+": "+e.parent().children().not(e).text()+"\n"}});return i=j+" error(s) encountered! \n"+i};f.SPWidgets.fillTemplate=function(c,i){var d={},j,e,b,q,s;d.response="";d.template=String(f("<div/>").append(c).html());d.tokens=d.template.match(/(\{\{.*?\}\})/g);f.isArray(i)||(i=[i]);if(d.tokens!==null){b=0;for(q=i.length;b<q;b++){s=d.template;j=0;for(e=d.tokens.length;j<e;j++){d.tokens[j]=d.tokens[j].replace(/[\{\{\}\}]/g,
"");s=s.replace("{{"+d.tokens[j]+"}}",i[b][d.tokens[j]])}d.response+=s}}return d.response};f.SPWidgets.parseLookupFieldValue=function(c){var i=[],d=String(c).split(";#"),j=d.length,e,b;if(c===undefined)return i;for(c=0;c<j;c++){e=d[c];c++;b=d[c];if(e||b)i.push({id:e,title:b})}return i};f.SPWidgets.getCamlLogical=function(c){c=f.extend({},{type:"AND",values:[],onEachValue:null},c);var i="<And>",d="</And>",j="",e=0,b=0,q=false;c.type=String(c.type).toUpperCase();if(!f.isArray(c.values))c.values=[c.values];
if(c.type!=="AND"){i="<Or>";d="</Or>"}j=i;e=c.values.length;b=e-1;q=f.isFunction(c.onEachValue);if(e<2)j="";for(i=0;i<e;i++){j+=q?String(c.onEachValue(c.values[i])).toString():String(c.values[i]).toString();if(b-i>1){j+=f.SPWidgets.getCamlLogical(f.extend({},c,{values:c.values.splice(i+1,e-i)}));break}}if(e>1)j+=d;return j};f.SPWidgets.SPGetDateString=function(c,i){function d(e){return e<10?"0"+e:e}i=String(i||"local").toLowerCase();c=c||new Date;var j="";return j=i==="utc"?c.getUTCFullYear()+"-"+
d(c.getUTCMonth()+1)+"-"+d(c.getUTCDate())+"T"+d(c.getUTCHours())+":"+d(c.getUTCMinutes())+":"+d(c.getUTCSeconds())+"Z":c.getFullYear()+"-"+d(c.getMonth()+1)+"-"+d(c.getDate())+"T"+d(c.getHours())+":"+d(c.getMinutes())+":"+d(c.getSeconds())};f.SPWidgets.makeSameHeight=function(c,i){var d=0,j=f(c);j.each(function(){var e=f(this).css("height","");if(d<e.outerHeight(true))d=e.outerHeight(true)});if(d>0){if(i)d+=i;j.height(d)}return c};f.SPWidgets.escapeXML=function(c){if(typeof c!=="string")return"";
return c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")};f.SPWidgets.unEscapeXML=function(c){if(typeof c!=="string")return"";return c.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&apos;/g,"'").replace(/&quot;/g,'"')}})(f);(function(a){var c={};c.initDone=false;c.maxColumns=20;a.SPWidgets.defaults.board={list:"",field:"",CAMLQuery:"<Query></Query>",CAMLViewFields:"",fieldFilter:null,optionalLabel:"(none)",template:null,
webURL:a().SPServices.SPGetCurrentSite(),showColPicker:false,colPickerLabel:"Columns",colPickerCloseLabel:"Close",colPickerApplyLabel:"Apply",onGetListItems:null,onPreUpdate:null,onBoardCreate:null};a.fn.SPShowBoard=function(i){if(!c.initDone){c.initDone=true;c.styleSheet!==""&&a('<style type="text/css">\n\n'+c.styleSheet+"\n\n</style>").prependTo("head")}return this.each(function(){var d=a(this),j=typeof i==="string",e=d.hasClass("hasSPShowBoard"),b=null,q="",s=null;if(e&&!j)return this;else if(j&&
e&&!d.hasClass("loadingSPShowBoard")){q=i.toLowerCase();s=d.data("SPShowBoardOptions");if(q==="refresh")s._getListItems().then(function(){s.showItemsOnBoard({refresh:true})});else if(q==="redraw"){s.statesCntr.find("div.spwidget-board-state").sortable("refresh");a.SPWidgets.makeSameHeight(s.statesCntr.find("div.spwidget-board-state"),20)}return this}if(d.hasClass("loadingSPShowBoard"))return this;b=a.extend({},a.SPWidgets.defaults.board,i,{ele:d,states:[],statesMap:{},tmpltHeader:"",tmpltState:"",
statesCntr:"",headersCntr:"",listItems:[],initDone:false,formUrls:null,isStateRequired:true,showNumberOfColumns:10,getBoardStates:function(){return a.Deferred(function(g){a().SPServices({operation:"GetList",listName:b.list,cacheXML:true,async:false,webURL:b.webURL,completefunc:function(k,h){var l=a(k.responseXML),m=l.find("Fields Field[StaticName='"+b.field+"']");if(!m.length){m=l.find("Fields Field[DisplayName='"+b.field+"']");b.field=m.attr("StaticName")}if(m.attr("Required")==="FALSE")b.isStateRequired=
false;switch(m.attr("Type").toLowerCase()){case "choice":if(!b.isStateRequired){b.states.push({type:"choice",title:b.optionalLabel,name:b.optionalLabel});b.statesMap[""]=b.states[b.states.length-1]}if(b.fieldFilter)b.fieldFilter=b.fieldFilter.split(/\,/);m.find("CHOICES CHOICE").each(function(n){var p=a(this).text();if(b.fieldFilter)if(!a.grep(b.fieldFilter,function(r){return r===p}).length)return;if(n>=c.maxColumns){try{console.log("SPWIDGETS:BOARD:Warning: Can only build a max of "+c.maxColumns+
" columns!")}catch(t){}return false}b.states.push({type:"choice",title:p,name:p});b.statesMap[p]=b.states[b.states.length-1]});g.resolveWith(b,[k,h]);break;case "lookup":if(!b.fieldFilter)b.fieldFilter="<Query></Query>";a().SPServices({operation:"GetListItems",listName:m.attr("List"),async:true,cacheXML:true,CAMLQuery:b.fieldFilter,webURL:b.webURL,CAMLRowLimit:0,CAMLViewFields:'<ViewFields><FieldRef Name="'+m.attr("ShowField")+'" /></ViewFields>',completefunc:function(n,p){if(p==="error")g.rejectWith(d,
["Communications Error!",n,p]);else{var t=a(n.responseXML);if(t.SPMsgHasError())g.rejectWith(d,[t.SPGetMsgError(),n,p]);else{if(!b.isStateRequired){b.states.push({type:"lookup",title:b.optionalLabel,name:""});b.statesMap[""]=b.states[b.states.length-1]}t.SPFilterNode("z:row").each(function(r){if(r>=c.maxColumns){try{console.log("SPWIDGETS:BOARD:Warning: Can only build a max of "+c.maxColumns+" columns!")}catch(u){}return false}var v=a(this);r=v.attr("ows_ID");v=v.attr("ows_"+m.attr("ShowField"));
r=r+";#"+v;b.states.push({type:"lookup",title:v,name:r});b.statesMap[r]=b.states[b.states.length-1]});g.resolveWith(b,[n,p])}}}})}}})}).promise()},_getListItems:function(){return a.Deferred(function(g){function k(h){a.isFunction(b.onGetListItems)&&b.onGetListItems.call(d,b.listItems,h);g.resolveWith(d,[b.listItems])}a.isFunction(b.CAMLQuery)?b.CAMLQuery.call(d,function(h){if(a.isArray(h)){b.listItems=h;k(b.CAMLQuery)}},i):a().SPServices({operation:"GetListItems",listName:b.list,async:true,CAMLQuery:b.CAMLQuery,
CAMLRowLimit:0,CAMLViewFields:b.CAMLViewFields,webURL:b.webURL,completefunc:function(h,l){if(l==="error")g.rejectWith(d,["Communications Error!",h,l]);else{var m=a(h.responseXML);if(m.SPMsgHasError())g.rejectWith(d,[m.SPGetMsgError(),h,l]);else{b.listItems=m.SPFilterNode("z:row").SPXmlToJson({includeAllAttrs:true});k(m)}}}})}).promise()},getBoardItemDataObject:function(g){var k=null,h,l,m;if(g){g=String(g);h=0;for(l=b.listItems.length;h<l;h++){m=b.listItems[h].ID;if(a.isFunction(m))m=b.listItems[h].ID();
m=String(m);if(g===m){k=b.listItems[h];h=l+l}}}return k},showItemsOnBoard:function(g){function k(w,y){var x="",z=null,A="";if(a.isFunction(b.template)){if(x=b.template.call(d,w,y))x=String(x)}else x=a.SPWidgets.fillTemplate(b.template,u);if(y!==undefined&&x!=="")y.html(x);else if(x!==""){z=w.ID;if(a.isFunction(w.ID))z=w.ID();if(n[t]===undefined)n[t]="";if(b.initDone&&h.refresh)A+=" spwidget-temp";n[t]+='<div class="spwidget-board-state-item ui-state-default ui-corner-all'+A+'" data-id="'+z+'">'+x+
"</div>"}return x}var h=a.extend({},{rows:b.listItems,refresh:false,doBoardInsert:true},g);g=[];var l=[],m=[],n={},p=null,t=null,r=p=null,u=null,v;if(!h.refresh){r=0;for(v=b.states.length;r<v;r++){b.states[r].headerTotalEle.html("0");b.states[r].dataEle.empty()}}r=0;for(v=h.rows.length;r<v;r++){u=h.rows[r];t=u[b.field]||"";p=u.ID;if(a.isFunction(t))t=u[b.field]();if(a.isFunction(p))p=p();if(b.statesMap[t])if(h.refresh===false){b.initDone&&g.push(u);k(u)}else{p=b.statesCntr.find("div[data-id='"+p+
"']");if(p.length){p.addClass("spwidget-temp");if(p.closest("div.spwidget-board-state").data("boardstate")!==t){p.appendTo(b.statesMap[t].dataEle);m.push(u)}k(u,p)}else{b.initDone&&g.push(u);k(u)}}}if(h.doBoardInsert){for(r in n)n.hasOwnProperty(r)&&n[r]!==""&&b.statesMap[r].dataEle.append(n[r]);b.updBoardHeaders();a.pt.addHoverEffect(d.find(".spwidget-board-state-item"))}b.initDone&&h.refresh&&b.statesCntr.find("div.spwidget-board-state-item").not("div.spwidget-temp").each(function(){l.push(b.getBoardItemDataObject(a(this).data("id")));
a(this).remove()}).end().removeClass("spwidget-temp");if(b.initDone){b.statesCntr.find("div.spwidget-board-state").sortable("refresh").end().disableSelection();a.SPWidgets.makeSameHeight(b.statesCntr.find("div.spwidget-board-state"),20);r=b.getEventObject();if(g.length){r.itemsModified.length=0;r.itemsModified.push(g);d.trigger("spwidget:boarditemadd",[d,a.extend({},r)])}if(l.length){r.itemsModified.length=0;r.itemsModified.push(l);d.trigger("spwidget:boarditemremove",[d,a.extend({},r)])}r.itemsModified.length=
0;r.itemsModified.push.apply(r.itemsModified,g);r.itemsModified.push.apply(r.itemsModified,l);r.itemsModified.push.apply(r.itemsModified,m);r.itemsModified.length&&d.trigger("spwidget:boardchange",[d,r])}return n},updBoardHeaders:function(g){var k;if(!a.extend({},{state:null},g).state){g=0;for(k=b.states.length;g<k;g++)b.states[g].headerTotalEle.html(b.states[g].dataEle.children().length)}},getEventObject:function(g){g||(g=b.statesCntr.find("div.spwidget-board-state-item:first"));g=a(g);g={stateTotals:{},
itemTotal:0,currentState:g.closest("div.spwidget-board-state").data("boardstate"),itemObj:b.getBoardItemDataObject(g.data("id"))||{},itemsModified:[]};var k,h;k=0;for(h=b.states.length;k<h;k++)g.itemTotal+=g.stateTotals[b.states[k].name]=Number(b.states[k].headerTotalEle.text());return g},getListFormUrl:function(g){function k(){a().SPServices({operation:"GetFormCollection",listName:b.list,webURL:b.webURL,cacheXML:true,async:false,completefunc:function(h){a(h.responseXML).find("Form").each(function(){var l=
a(this);b.formUrls[String(l.attr("Type")).toLowerCase()]=b.webURL+"/"+l.attr("Url")})}})}g=String(g).toLowerCase();if(b.formUrls===null){b.formUrls={};k()}return b.formUrls[g]||""},setBoardColumnClass:function(g){var k=b.headersCntr.add(b.statesCntr);g=parseInt(g);if(!g||g<2){g=0;a.each(b.states,function(h,l){l.isVisible&&g++})}if(b.showNumberOfColumns===g)return b;k.addClass("spwidget-states-"+g);b.showNumberOfColumns&&k.removeClass("spwidget-states-"+b.showNumberOfColumns);b.showNumberOfColumns=
g;return b},setupColumnPicker:function(){var g=d.find(".spwidget-board-column-list-cntr"),k=g.find("div.spwidget-board-column-list"),h={};h.getSelected=function(){return k.find("a.ui-state-highlight")};h.showMessage=function(l){a('<div class="spwidget-board-msg ui-state-error">'+l+"</div>").appendTo(k).fadeOut(8E3,function(){a(this).remove()})};h.setSelected=function(){var l=k.find("a");a.each(b.states,function(m,n){var p=l.filter("[data-board_col_index='"+m+"']");n.isVisible?h.selectColumn(p,false):
h.selectColumn(p,true)})};h.selectColumn=function(l,m){var n=a(l),p=n.find(".ui-icon");if(n.hasClass("ui-state-highlight")||m){if(m!==false){p.removeClass("ui-icon-check");n.removeClass("ui-state-highlight")}}else{p.addClass("ui-icon-check");n.addClass("ui-state-highlight")}return l};g.find("button[name='apply']").button({label:b.colPickerApplyLabel,icons:{secondary:"ui-icon-circle-check"}}).on("click",function(){var l=h.getSelected(),m=l.length;if(m>10)h.showMessage("Max Exceeded!");else if(m<2)h.showMessage("Min Not Met!");
else{g.hide();a.each(b.states,function(n,p){if(l.filter("[data-board_col_index='"+n+"']").length){if(p.isVisible===false){p.isVisible=true;p.dataEle.css("display","");p.headerEle.css("display","")}}else{p.isVisible=false;p.dataEle.css("display","none");p.headerEle.css("display","none")}});b.setBoardColumnClass(m)}});g.find("button[name='close']").attr("title",b.colPickerCloseLabel).button({text:false,icons:{primary:"ui-icon-circle-close"}}).on("click",function(){g.hide()});d.find("div.spwidget-board-settings").css("display",
"").find("div.spwidget-board-settings-columns").each(function(){var l=a(this);l.button({label:b.colPickerLabel,icons:{secondary:"ui-icon-triangle-1-s"}}).on("click.SPWidgets",function(){if(g.is(":visible"))g.hide();else{h.setSelected();g.show().position({my:"left top",at:"left bottom",of:l})}});return false});k.each(function(){var l=a(this),m="";a.each(b.states,function(n,p){m+='<a href="javascript:" data-board_col_index="'+n+'"><span class="ui-icon ui-icon-minus"></span><span>'+p.title+"</span></a>"});
l.html(m);return false}).on("click","a",function(){h.selectColumn(this)})}});if(!b.list||!b.field){d.html("<div>SPWidgets:Board [ERROR] Missing required input parameters!</div>");return this}d.addClass("loadingSPShowBoard").data("SPShowBoardOptions",b);b.getBoardStates().then(function(){d.html(a(c.htmlTemplate).filter("div.spwidget-board"));b.tmpltHeader=a("<div/>").append(d.find("div.spwidget-board-headers-cntr div.spwidget-board-state").clone()).html();b.tmpltState=a("<div/>").append(d.find("div.spwidget-board-states-cntr div.spwidget-board-state")).html();
if(b.states.length<11)b.showNumberOfColumns=b.states.length;else b.showColPicker=true;b.statesCntr=d.find("div.spwidget-board-states-cntr").addClass("spwidget-states-"+b.showNumberOfColumns).empty();b.headersCntr=d.find("div.spwidget-board-headers-cntr").addClass("spwidget-states-"+b.showNumberOfColumns).empty();a.each(b.states,function(g,k){k.headerEle=a(b.tmpltHeader).appendTo(b.headersCntr).attr("data-boardstate",k.name).attr("data-boardindex",g).html(k.title);k.dataEle=a(b.tmpltState).appendTo(b.statesCntr).attr("data-boardindex",
g).attr("data-boardstate",k.name);k.headerTotalEle=a('<span>&nbsp;[<span class="spwidget-state-item-total">0</span>]</span>').appendTo(k.headerEle).find("span.spwidget-state-item-total");k.isVisible=true;if(g>9){k.headerEle.css("display","none");k.dataEle.css("display","none");k.isVisible=false}});a(b.headersCntr,b.statesCntr).append('<div style="clear:both;"></div>');b.showColPicker===true&&b.setupColumnPicker();d.on("sortreceive sortremove",function(g,k){b.updBoardHeaders();a(k.item).removeClass("ui-state-hover")}).on("sortreceive sortcreate",
function(g,k){var h=b.getEventObject(k.item),l,m;if(g.type==="sortcreate"){a.isFunction(b.onBoardCreate)&&b.onBoardCreate.call(d,h);a(g.target).trigger("spwidget:boardcreate",[d,h])}else{l=a.Deferred();m="";m=a.isFunction(h.itemObj.ID)?h.itemObj.ID():h.itemObj.ID;h.updates=[];h.updatePromise=l.promise();h.updates.push([b.field,h.currentState]);if(a.isFunction(b.onPreUpdate))if(b.onPreUpdate.call(k.item,g,k.item,h)===true)return this;if(!h.updates.length)return this;a().SPServices({operation:"UpdateListItems",
listName:b.list,async:true,ID:m,valuepairs:h.updates,webURL:b.webURL,completefunc:function(n,p){if(p==="error")l.rejectWith(d,["Communications Error!",n,p]);else{var t=a(n.responseXML);if(t.SPMsgHasError())l.rejectWith(d,[t.SPGetMsgError(),n,p]);else{a(n.responseXML).SPFilterNode("z:row").SPXmlToJson({includeAllAttrs:true});a(g.target).trigger("spwidget:boardchange",[k.item,h]);l.resolveWith(g.target,[h.itemObj,n])}}}})}}).on("click","a.spwidgets-board-action",function(g){g=a(g.currentTarget);var k=
String(g.data("spwidgets_board_action")).toLowerCase(),h="",l=a.pt.getEscapedUrl(window.location.href);switch(k){case "edit-item":h=b.getListFormUrl("EditForm");break;case "view-item":h=b.getListFormUrl("DisplayForm")}window.location.href=h+"?ID="+g.data("spwidgets_id")+"&Source="+l;return this});if(b.template===null)b.template=a(c.htmlTemplate).filter("div.spwidget-item-template");b._getListItems().then(function(){b.showItemsOnBoard();b.statesCntr.find("div.spwidget-board-state").each(function(){var g=
a(this);g.sortable({connectWith:g.siblings(),containment:d,cursor:"move",tolerance:"pointer",opacity:".80",placeholder:"ui-state-highlight spwidget-board-placeholder",forcePlaceholderSize:true,remove:function(){a.SPWidgets.makeSameHeight(b.statesCntr.find("div.spwidget-board-state"),20)}})});b.statesCntr.disableSelection();b.initDone=true;a.SPWidgets.makeSameHeight(b.statesCntr.find("div.spwidget-board-state"),20);d.addClass("hasSPShowBoard").removeClass("loadingSPShowBoard")})});return this})};c.styleSheet=
"/** \n * Stylesheet for the Board widget\n * \n * BUILD: June 23, 2013 - 01:54 PM\n */\ndiv.spwidget-board {\n    width: 100%;\n    position: relative;\n}\n\ndiv.spwidget-board div.spwidget-board-headers,\ndiv.spwidget-board div.spwidget-board-headers-cntr,\ndiv.spwidget-board div.spwidget-board-states-cntr, \ndiv.spwidget-board div.spwidget-board-states {\n    width: 100%;\n}\n\ndiv.spwidget-board div.spwidget-board-state {\n    width: 49%;\n    float: left;\n    margin: .1%;\n    padding: .2%;\n    overflow: auto;\n}\n\ndiv.spwidget-board div.spwidget-board-headers-cntr {\n    border: none;\n}\ndiv.spwidget-board div.spwidget-board-headers-cntr div.spwidget-board-state {\n    text-align: center;\n    font-weight: bold;\n    font-size: 1.1em;\n}\ndiv.spwidget-board div.spwidget-board-states div.spwidget-board-state {\n    margin-bottom: 1em;\n    min-height: 10em;\n}\n\ndiv.spwidget-board div.spwidget-board-state div.spwidget-board-state-item {\n    padding: .2em;\n    margin: .5em .2em;\n    font-weight: normal;\n    cursor: move;\n    overflow: auto;\n}\ndiv.spwidget-board div.spwidget-board-state-item div.spwidget-board-item-actions{\n    margin-top: .5em;\n    padding: .2em .5em;\n    width: 25%;\n    overflow: hidden;\n    text-align: center;\n}\ndiv.spwidget-board .spwidget-board-placeholder {\n    height: 3em;\n}\n\n/** Setting container */\ndiv.spwidget-board-settings {\n    font-size: .8em;\n    margin: .2em;\n}\ndiv.spwidget-board-settings div.spwidget-board-column-list-cntr {\n    z-index: 5;\n    position: absolute;\n}\ndiv.spwidget-board-settings div.spwidget-board-column-list-cntr > div {\n    padding: .2em;\n}\ndiv.spwidget-board-settings div.spwidget-board-column-list-cntr > div:first-child,\ndiv.spwidget-board-settings div.spwidget-board-column-list-cntr > div:last-child {\n    text-align: right;\n}\ndiv.spwidget-board-settings div.spwidget-board-column-list {\n    width: 20em;\n    height: 17em;\n    overflow: auto;\n    position: relative\n}\ndiv.spwidget-board-settings div.spwidget-board-column-list > .spwidget-board-msg {\n    position: absolute;\n    top: 0px;\n    right: 0px;\n    padding: .2em 1.5em;\n}\ndiv.spwidget-board-settings div.spwidget-board-column-list > a {\n    display: block;\n    margin: .2em;\n    padding: .2em;\n}\ndiv.spwidget-board-settings div.spwidget-board-column-list > a > span.ui-icon {\n    display: inline-block;\n}\n\n/* Number of Columns (96 % #columns)\n * Currently support 10 columns. \n */\ndiv.spwidget-board .spwidget-states-3 div.spwidget-board-state {\n    width: 32.4%;\n}\ndiv.spwidget-board .spwidget-states-4 div.spwidget-board-state {\n    width: 24%;\n}\ndiv.spwidget-board .spwidget-states-5 div.spwidget-board-state {\n    width: 19.1%;\n}\ndiv.spwidget-board .spwidget-states-6 div.spwidget-board-state {\n    width: 15.8%;\n}\ndiv.spwidget-board .spwidget-states-7 div.spwidget-board-state {\n    width: 13.4%;\n}\ndiv.spwidget-board .spwidget-states-8 div.spwidget-board-state {\n    width: 11.6%;\n}\ndiv.spwidget-board .spwidget-states-9 div.spwidget-board-state {\n    width: 10.2%;\n}\ndiv.spwidget-board .spwidget-states-10 div.spwidget-board-state {\n    width: 9.1%;\n}\n";
c.htmlTemplate='<div class="spwidget-board">\n    <div class="spwidget-board-settings" style="display:none;">\n        <div class=\'spwidget-board-settings-columns\'>Columns</div>\n        <div class="spwidget-board-column-list-cntr ui-widget-content ui-corner-all" style="display: none">\n            <div class="ui-state-default">\n                <button type="button" name="close" title="Close">close</button>\n            </div>\n            <div class="spwidget-board-column-list">\n            </div>\n            <div class="ui-state-default">\n                <button type="button" name="apply">Apply</button>\n            </div>\n        </div>\n    </div>\n    <div class="spwidget-board-headers">\n        <div class="spwidget-board-headers-cntr ui-widget-content ui-corner-all">\n            <div class="spwidget-board-state ui-widget-content ui-corner-all"></div>\n            <div style="clear:both;"></div>\n        </div>\n    </div>\n    <div style="clear:both;"></div>\n    <div class="spwidget-board-states">\n        <div class="spwidget-board-states-cntr">\n            <div class="spwidget-board-state ui-widget-content ui-corner-all"></div>\n            <div style="clear:both;"></div>\n        </div>\n    </div>\n    <div style="clear:both;"></div>\n</div>\n<div class="spwidget-item-template">\n    <div>\n        <div>#{{ID}}: {{Title}}</div>\n        <div class="ui-state-active ui-corner-all spwidget-board-item-actions">\n            <a class="spwidgets-board-action" href="javascript:" title="View Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="view-item"><img src="/_layouts/images/icgen.gif" border="0"/></a>\n            <a class="spwidgets-board-action" href="javascript:" title="Edit Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="edit-item"><img src="/_layouts/images/CMSEditSourceDoc.GIF" border="0"/></a>\n        </div>\n    </div>\n</div>\n'})(f);
(function(a){var c={_islookupFieldCssDone:false};a.SPWidgets.defaults.LookupField={list:"",allowMultiples:true,inputLabel:"",inputPlaceholder:"Type and Pick",readOnly:false,exactMatch:true,uiContainer:null,selectFields:["Title"],filter:"",filterFields:["Title"],template:'<div>{{Title}} <span class="spwidgets-item-remove">[x]</span></div>',listTemplate:"{{Title}}",listHeight:0,onItemAdd:null,onItemRemove:null,onReady:null,msgNoItems:"",maxResults:50,minLength:2,hideInput:true,padDelimeter:false,showSelector:false};
a.fn.SPLookupField=function(i){if(!c._islookupFieldCssDone){c._islookupFieldCssDone=true;a('<style type="text/css">\n\n'+c.styleSheet+"\n\n</style>").prependTo("head")}var d=arguments;this.each(function(){var j=a(this);if(!j.is("input")&&!j.is("textarea")||j.hasClass("hasLookupSPField")){if(typeof i==="string"&&j.is("input")){var e=j.data("SPWidgetLookupFieldUI").data("SPWidgetLookupFieldOpt");if(i.toLowerCase()==="method"){j=String(d[1]||"").toLowerCase();var b=d[2]||{};if(j==="clear")if(b.id===
undefined){e._cntr.find("div.spwidgets-lookup-selected").css("display","none").empty();e._ele.val("");e._cntr.find("div.spwidgets-lookup-input").css("display","")}else alert("TBD... Delete individual ID's")}}return this}e=a.extend({},a.SPWidgets.defaults.LookupField,i,{_ele:j.css("display","none").addClass("hasLookupSPField")});e.showSelectedItems=function(g,k){var h=e._selectedItemsCntr.css("display",""),l=[],m=false;if(!h.find("div.spwidgets-item").length||e.allowMultiples===false)h.empty();if(a.isArray(g))l=
g;else l.push(g);a.each(l,function(n,p){if(!h.find("div.spwidgets-item-id-"+p.ID).length){var t=a('<div class="spwidgets-item spwidgets-item-id-'+p.ID+'" data-spid="'+p.ID+'" style="display:none">'+a.SPWidgets.fillTemplate(e.template,p)+"</div>").find(".spwidgets-item-remove").on("click.SPWidgets",function(){c.removeItem(e,this)}).end().appendTo(h);a.isFunction(e.onItemAdd)&&e.onItemAdd.call(e._ele,t,p,e._cntr);if(h.find("div.spwidgets-item-id-"+p.ID).length>0){m=true;t.fadeIn("slow").promise().then(function(){a(this).css("display",
"")});k!==true&&e.storeItemIDs(p.ID,e.allowMultiples);e.allowMultiples===false&&e.hideInput===true&&e._lookupInputEleCntr.css("display","none")}}});m&&e._ele.trigger("change")};e.storeItemIDs=function(g,k){var h=a.trim(e._ele.val()),l=false;a.isArray(g)||(g=[g]);if(k!==true)h="";a.each(g,function(m,n){if(n){if(h.length<1&&e.padDelimeter===true&&!l){h+=";#";l=true}if(h.length>0)h+=";#";h+=n+";#"}});e._ele.val(h)};e._cntr=a(c.htmlTemplate).find(".spwidgets-lookup-cntr").clone(1);e._selectedItemsCntr=
e._cntr.find("div.spwidgets-lookup-selected");e._lookupInputEleCntr=e._cntr.find("div.spwidgets-lookup-input");e._cntr.data("SPWidgetLookupFieldOpt",e);e._ele.data("SPWidgetLookupFieldUI",e._cntr);e.uiContainer===null?e._cntr.insertAfter(e._ele):e._cntr.appendTo(a(e.uiContainer));if(e.showSelector){var q=e._cntr.find("div.ptLookupSPFieldSelectorCntr");e._cntr.find(".ptLookupSPFieldSelector").on("click",function(){q.is(":visible")?q.css("display","none"):q.css("display","block")})}else e._cntr.find(".ptLookupSPFieldSelectorCntr,.ptLookupSPFieldSelector").remove();
e.inputLabel?e._cntr.find("div.spwidgets-lookup-input label").empty().append(e.inputLabel):e._cntr.find("div.spwidgets-lookup-input label").remove();e.inputPlaceholder&&e._lookupInputEleCntr.find("input").attr("placeholder",e.inputPlaceholder);if(e.readOnly===true){e._lookupInputEleCntr.css("display","none");e._cntr.find("div.spwidget-lookup").addClass("spwidget-lookup-readyonly")}e._selectFields="";a.each(e.selectFields,function(g,k){e._selectFields+="<FieldRef Name='"+k+"'/>"});e._templateTokens=
String(e.template).match(/(\$\{.*?\})/g);if(e._templateTokens==null)e._templateTokens=[];a.each(e._templateTokens,function(g,k){e._templateTokens[g]=k.replace(/[\$\{\}]/g,"")});var s={};e._cntr.find("div.spwidgets-lookup-input input").autocomplete({minLength:2,appendTo:e._cntr,open:function(){a(this).autocomplete("widget").each(function(){e.listHeight>0&&a(this).css("height",e.listHeight+"px");return false})},source:function(g,k){g.term=a.trim(g.term);var h=String(a.trim(g.term)).toUpperCase();if(h in
s)k(s[h]);else{s[h]=[];var l=[],m=String(g.term);if(m.match(/\D/)===null&&m.match(/\d/)!==null)l.push("<Eq><FieldRef Name='ID'/><Value Type='Counter'>"+m+"</Value></Eq>");else{m=[g.term];e.exactMatch||(m=String(g.term).split(/ /));for(var n=0,p=e.filterFields.length;n<p;n++){for(var t=[],r=0,u=m.length;r<u;r++)/^(of|and|a|an|to|by|the|or)$/i.test(m[r])||t.push("<Contains><FieldRef Name='"+e.filterFields[n]+"'/><Value Type='Text'>"+m[r]+"</Value></Contains>");l.push(a.SPWidgets.getCamlLogical({values:t,
type:"AND"}))}}l=a.SPWidgets.getCamlLogical({values:l,type:"OR"});if(e.filter)l=a.SPWidgets.getCamlLogical({values:[l,e.filter],type:"AND"});a().SPServices({operation:"GetListItems",listName:e.list,async:true,CAMLQuery:"<Query><Where>"+l+"</Where></Query>",CAMLRowLimit:e.maxResults,CAMLViewFields:"<ViewFields>"+e._selectFields+"</ViewFields>",completefunc:function(v){a(v.responseXML).SPFilterNode("z:row").each(function(){var w=a(this).SPXmlToJson({includeAllAttrs:true})[0];w.value="";w.label=a.SPWidgets.fillTemplate(e.listTemplate,
w);s[h].push(w)});k(s[h])}})}},select:function(g,k){e.showSelectedItems(k.item)}}).on("keyup.SPWidgets",function(g){if(g.which==13){var k=a(g.target).val();k&&String(k).length<e.minLength&&a(g.target).autocomplete("search",k+"    ")}});j=a.SPWidgets.parseLookupFieldValue(e._ele.val());if(j.length)a().SPServices({operation:"GetListItems",async:true,listName:e.list,CAMLQuery:"<Query><Where>"+a.SPWidgets.getCamlLogical({type:"OR",values:j,onEachValue:function(g){var k="";if(g.id)k="<Eq><FieldRef Name='ID'/><Value Type='Counter'>"+
g.id+"</Value></Eq>";return k}})+"</Where></Query>",CAMLViewFields:"<ViewFields>"+e._selectFields+"</ViewFields>",CAMLRowLimit:0,completefunc:function(g){g=a(g.responseXML).SPFilterNode("z:row").SPXmlToJson({includeAllAttrs:true,removeOws:true});e.showSelectedItems(g,true);e.readOnly&&e._cntr.find(".spwidgets-item-remove").remove();a.isFunction(e.onReady)&&e.onReady.call(e._ele,e._cntr);return this}});else a.isFunction(e.onReady)&&e.onReady.call(e._ele,e._cntr);return this});return this};c.removeItem=
function(i,d){var j=a(d).closest("div.spwidgets-item"),e=j.closest("div.spwidgets-lookup-selected"),b=j.data("spid"),q=a.SPWidgets.parseLookupFieldValue(i._ele.val()),s=[],g=0,k=0;j.fadeOut("fast").promise().then(function(){j.remove();if(!i.msgNoItems&&(i.allowMultiples===false||i.allowMultiples===true&&e.find("div.spwidgets-item").length<1))e.css("display","none");i.allowMultiples===false&&i.hideInput===true&&i._lookupInputEleCntr.css("display","");e.find("div.spwidgets-item").length<1&&i.msgNoItems&&
e.append("<div>"+i.msgNoItems+"</div>")});g=0;for(k=q.length;g<k;g++)q[g].id!=b&&s.push(q[g].id);i.storeItemIDs(s);i._lookupInputEleCntr.find("input").focus();return c};c.styleSheet='/**\n * Stylesheet for the Lookup Field widget.\n * \n */\n\n.spwidgets-lookup-cntr {\n    position: relative;\n    display: inline-block;\n    zoom: 1; /* IE7 hack */\n    *display: inline; /* IE7 hack */\n}\n\n\n.spwidgets-lookup-cntr .spwidgets-lookup-selected {\n    -moz-appearance: textfield;\n    -webkit-appearance: textfield;\n    background-color: white;\n    background-color: -moz-field;\n    border: 1px solid  darkgray;\n    box-shadow: 1px 1px 1px 0 lightgray inset;  \n    font: -moz-field;\n    font: -webkit-small-control;\n    margin-top: 5px;\n    padding: 2px 5px; \n}\n\n.spwidgets-lookup-cntr  .spwidgets-lookup-selected .spwidgets-item {\n    display: inline-block;\n    margin-left: .5em;\n}\n.spwidgets-lookup-cntr .spwidgets-item:first-child {\n    margin-left: 0px;\n}\n.spwidgets-lookup-cntr .spwidgets-item-remove {\n    color: red;\n    cursor: pointer;\n}\n\n.spwidgets-lookup-cntr .spwidgets-lookup-input {\n    margin: .2em 0em;\n    position: relative;\n}\n.spwidgets-lookup-cntr .ptLookupSPFieldSelector {\n    height: 16px;\n    width: 16px;\n    text-indent: -99999px;\n    background-repeat: no-repeat;\n    background-image: url("/_layouts/images/ARRDOWNI.GIF");\n    display: inline-block;\n}\n.spwidgets-lookup-cntr .ptLookupSPFieldSelectorCntr {\n    display: none;\n    position: absolute;\n    height: 150px;\n    width: 98%;\n    left: 0px;\n    overflow: auto;\n    z-index: 2000;\n}\n.spwidgets-lookup-cntr ul.ui-autocomplete {\n    overflow: auto;\n}\n\n/* Ready only display */\n.spwidgets-lookup-cntr div.spwidget-lookup-readyonly .spwidgets-lookup-selected {\n    -moz-appearance: none;\n    -webkit-appearance: none;\n    background-color: transparent;\n    border: none;\n    box-shadow: none;\n    font: inherit;\n}\n.spwidgets-lookup-cntr div.spwidget-lookup-readyonly .spwidgets-item-remove {\n    display: none;\n}\n';
c.htmlTemplate='<div>\n    <div class="spwidgets-lookup-cntr">\n        <div class="spwidget-lookup">\n            <div class="spwidgets-lookup-selected" style="display:none;">\n            </div>\n            <div class="spwidgets-lookup-input">\n                <label>Add</label>\n                <input type="text" name="ptLookupSPFieldAdd" value="" />\n                <span class="ptLookupSPFieldSelector">Select</span>\n                <div class="ptLookupSPFieldSelectorCntr ui-widget-content">\n                    <div style="height: 1000px;"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n'})(f);
f.pt.pickSPUser={_isPickSPUserCssDone:false};f.fn.pickSPUser=function(a){if(!f.pt.pickSPUser._isPickSPUserCssDone){f.pt.pickSPUser._isPickSPUserCssDone=true;f('<style type="text/css">\n\n'+f.pt.pickSPUser.styleSheet+"\n\n</style>").prependTo("head")}var c=arguments;this.each(function(){var i=f(this);if(!i.is("input")||i.hasClass("hasPickSPUser"))return typeof a==="string"&&i.is("input")?f.pt.pickSPUser.handleAction.apply(this,c):this;var d=f.extend({},{allowMultiples:true,maxSearchResults:50,webURL:f().SPServices.SPGetCurrentSite(),
onPickUser:null,onCreate:null,onRemoveUser:null,inputPlaceholder:"Type and Pick"},a,{eleUserInput:i.css("display","none").addClass("hasPickSPUser")});d.maxSearchResults=parseInt(d.maxSearchResults)||50;var j=f(f.pt.pickSPUser.htmlTemplate).find(".pt-pickSPUser").clone(1).insertAfter(i);d.eleSelected=j.find("div.pt-pickSPUser-selected").empty();d.elePickInput=j.find("div.pt-pickSPUser-input");d.addPeopleToList=function(b,q){var s=(new String(b)).split(";#"),g=s.length,k,h,l;for(k=0;k<g;k++){h=s[k];
k++;l=s[k];h=f.pt.pickSPUser.getUserHtmlElement(d,h,l).appendTo(d.eleSelected);(function(m,n){d.getSearchResults(n).done(function(p){var t=String(n).toLowerCase();f.each(p,function(r,u){if(String(u.displayName).toLowerCase()===t){m.data("pickspuser_object",u);return false}})})})(h,l)}f.pt.addHoverEffect(d.eleSelected.find("div.pt-pickSPUser-person-cntr"));d.allowMultiples===false&&d.elePickInput.css("display","none");f.pt.pickSPUser.storeListOfUsers(d.eleSelected,q)};d.getSearchResults=function(b){return f.Deferred(function(q){f().SPServices({operation:"SearchPrincipals",
searchText:b,maxResults:d.maxSearchResults,async:true,webURL:d.webURL,completefunc:function(s,g){var k=[];f(s.responseXML).find("PrincipalInfo").each(function(){var h=f(this);k.push({displayName:h.find("DisplayName").text(),accountId:h.find("UserInfoID").text(),accountName:h.find("AccountName").text(),accountType:h.find("PrincipalType").text(),value:h.find("DisplayName").text(),label:h.find("DisplayName").text()})});q.resolveWith(s,[k,s,g])}})}).promise()};d.allowMultiples===true&&d.eleSelected.addClass("pt-pickSPUser-selected-multiple");
i.val()&&d.addPeopleToList(i.val(),noEvents);var e={};d.elePickInput.find("input[name='pickSPUserInputField']").attr("placeholder",d.inputPlaceholder).autocomplete({minLength:3,source:function(b,q){if(b.term in e)q(e[b.term]);else{e[b.term]=[];d.getSearchResults(b.term).then(function(s){e[b.term].push.apply(e[b.term],s);q(e[b.term])})}},select:function(b,q){if(d.allowMultiples===false)d.eleSelected.empty();else if(d.eleSelected.find("div[data-pickspuserid='"+q.item.accountId+"']").length)return;f.pt.pickSPUser.getUserHtmlElement(d,
q.item.accountId,q.item.displayName).appendTo(d.eleSelected).data("pickspuser_object",q.item);f.pt.pickSPUser.storeListOfUsers(j);f.pt.addHoverEffect(j.find("div.pt-pickSPUser-person-cntr"));setTimeout(function(){b.target.value=""},50);d.allowMultiples===false&&d.elePickInput.hide();f.isFunction(d.onPickUser)&&d.onPickUser.call(d.eleUserInput,f.extend({},q.item));i.trigger(f.Event("spwidget:peoplePickerAdd"),[d.eleUserInput,f.extend({},q.item)])}});j.data("pickSPUserContainerOpt",d);i.data("pickSPUserContainer",
j);f.isFunction(d.onCreate)&&d.onCreate.call(i,i);i.trigger(f.Event("spwidget:peoplePickerCreate"),[d.eleUserInput]);return this});return this};f.pt.pickSPUser.getUserHtmlElement=function(a,c,i){a=f(f.pt.pickSPUser.htmlTemplate).find(".pt-pickSPUser-person").clone(1);a.attr("data-pickSPUserID",c);a.find("span.pt-person-name").append(i).end().attr("data-pickSPUserNAME",i);return a};f.pt.pickSPUser.removeUser=function(a){var c=f(a).closest("div.pt-pickSPUser"),i=c.data("pickSPUserContainerOpt");a=f(a).closest("div.pt-pickSPUser-person");
var d=a.data("pickspuser_object");f.isFunction(i.onRemoveUser)&&i.onRemoveUser.call(i.ele,i.ele,a,d);a.fadeOut("fast",function(){f(this).remove();f.pt.pickSPUser.storeListOfUsers(c)});i.allowMultiples===false&&i.elePickInput.show("fast",function(){i.elePickInput.find("input").focus()});i.eleUserInput.trigger(f.Event("spwidget:peoplePickerRemove"),[i.eleUserInput,d])};f.pt.pickSPUser.storeListOfUsers=function(a,c){var i=f(a).closest("div.pt-pickSPUser"),d=i.data("pickSPUserContainerOpt"),j="",e={};
i.find("div.pt-pickSPUser-selected div.pt-pickSPUser-person").each(function(){if(!e[f(this).attr("data-pickSPUserID")]){e[f(this).attr("data-pickSPUserID")]=true;if(j)j+=";#";j+=f(this).attr("data-pickSPUserID");j+=";#";j+=f(this).attr("data-pickSPUserNAME")}});d.eleUserInput.val(j);c||d.eleUserInput.change()};f.pt.pickSPUser.handleAction=function(a,c,i){a=String(a).toLowerCase();c=String(c).toLowerCase();o=f(this).data("pickSPUserContainer").data("pickSPUserContainerOpt");ret=this;if(a==="method")switch(c){case "clear":o.eleUserInput.val("");
o.eleSelected.empty();if(o.allowMultiples===false){o.eleSelected.css("display","none");o.elePickInput.show()}break;case "destroy":f(this).hasClass("hasPickSPUser")&&f(this).removeClass("hasPickSPUser").next(".pt-pickSPUser").remove().show().trigger("change");break;case "add":o.addPeopleToList(i);break;case "remove":if(i){a=o.eleSelected.find("div[data-pickspuserid='"+i+"']");a.length||(a=o.eleSelected.find("div[data-pickspusername='"+i+"']"));a.length&&f.pt.pickSPUser.removeUser(a)}break;case "getSelected":ret=
f.SPWidgets.parseLookupFieldValue(o.eleUserInput.val())}return ret};f.pt.pickSPUser.styleSheet="/**\n * Styles for the Pick User Widget\n */\n.pt-pickSPUser .pt-pickSPUser-selected-multiple {\n    min-height: 3em;\n}\n\n.pt-pickSPUser .pt-pickSPUser-selected .pt-pickSPUser-person {\n    float: left;\n    margin-left: .2em;\n}\n.pt-pickSPUser .pt-pickSPUser-hint {\n    font-size: .9em;\n}\n\n\n.pt-pickSPUser .pt-pickSPUser-person-cntr {\n    margin: .2em 0em;\n    padding: .2em;\n    position: relative;\n}\n\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-person-name {\n    padding-right: 2em;\n}\n\n/* Item action container (delete button) */\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions {\n    position: absolute;\n    right: 1px;\n    top: 1px;\n    padding: .2em;\n    display: none;\n}\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions .pt-pickSPUser-person-action-links,\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions .pt-pickSPUser-person-action-links .tt-confirm-delete {\n    float:right;\n}\n\n/* Make the action visible if we hover or we are trying to confirm a deletion */\n.pt-pickSPUser .pt-pickSPUser-person-cntr.ui-state-hover .pt-pickSPUser-person-actions,\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions.tt-confirm,\n.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions a {\n    display:block;\n    float: right;\n}\n\n/* autocomplete busy image */\n.ui-autocomplete-loading {\n    background: white url('/_layouts/images/loading.gif') right center no-repeat;\n}\n\n\n";
f.pt.pickSPUser.htmlTemplate='<!--\n    Html Templates for the PickSPUser plugin.\n    \n    |\n    |   $Author$\n    | $Revision$\n    |     $Date$\n    |       $Id$\n    |\n--\>\n<div>\n    <div class="pt-pickSPUser">\n        <div class="pt-pickSPUser-selected">\n            None Selected!\n        </div>\n        <div style="clear:both"></div>\n        <div class="pt-pickSPUser-input" \n                title="Type user name above to view search results.">\n            <input name="pickSPUserInputField" value="" type="text"/>\n        </div>\n    </div>\n    \n    <div class="pt-pickSPUser-person">\n        <div class="pt-pickSPUser-person-cntr ui-state-default ui-corner-all">\n            <span class="pt-person-name"></span>\n            <div class="pt-pickSPUser-person-actions">\n                <div class="tt-record-item-action-links">\n                    <a class="tt-delete-icon" href="javascript:" onclick="jQuery.pt.pickSPUser.removeUser(this);">\n                        <img style="border: medium none; margin-right: 2px;" alt="Delete" src="/_layouts/images/delitem.gif">\n                    </a>\n                    <div style="clear:both;"></div>\n                </div>\n                <div style="clear:both;"></div>\n            </div>\n        </div>\n    </div>\n</div>\n';
f.pt.addHoverEffect=function(a){return f(a).each(function(){if(!f(this).hasClass("addHoverEffectDone")){f(this).addClass("addHoverEffectDone");var c=this;f(c).mouseenter(function(){f(c).toggleClass("ui-state-hover")});f(c).mouseleave(function(){f(c).toggleClass("ui-state-hover")})}})};f.pt._isSPUploadCssDone=false;f.fn.SPControlUpload=function(a){var c=f.extend({},{listName:"",folderPath:"",uploadDonePage:"/_layouts/viewlsts.aspx",onPageChange:null,uploadUrlOpt:"",overwrite:false,uploadPage:"/_layouts/Upload.aspx",
overlayClass:"",overlayBgColor:"white",overlayMessage:'<div class="loadingOverlayMsg">Loading...</div>'},a);if(!f.pt._isSPUploadCssDone){f.pt._isSPUploadCssDone=true;f('<style type="text/css">\n\n'+f.pt.SPUploadStyleSheet+"\n\n</style>").prependTo("head")}if(c.listName&&c.listName.indexOf("{")!=0)c.listName=f.pt.getListUID(c.listName);if(!c.listName){f(this).html('<div class="ui-state-error">Input parameter [listName] not valid!</div>');return this}c.siteUrl=f().SPServices.SPGetCurrentSite();if(String(c.uploadPage).toLowerCase().indexOf("http")==
-1){a="/";if(c.uploadPage.indexOf("/")==0)a="";c.uploadPage=c.siteUrl+a+c.uploadPage;c.uploadPage2=c.siteUrl+"/_layouts/UploadEx.aspx"}if(String(c.uploadDonePage).toLowerCase().indexOf("http")==-1){a="/";if(c.uploadDonePage.indexOf("/")==0)a="";c.uploadDonePage=c.siteUrl+a+c.uploadDonePage}c._uploadUrlParams="?List="+f.pt.getEscapedUrl(c.listName)+"&RootFolder="+f.pt.getEscapedUrl(c.folderPath)+"&Source="+f.pt.getEscapedUrl(c.uploadDonePage)+"&"+c.uploadUrlOpt;c.uploadPage+=c._uploadUrlParams;c.uploadPage2+=
c._uploadUrlParams;c._lastError="";c._reloadCount=0;c.ev={state:1,action:"uploading",hideOverlay:true,pageUrl:"",page:null,isUploadDone:false};var i="";if(c.overlayBgColor)i="style='background-color:"+c.overlayBgColor+";' ";f(this).each(function(){var d=f(this),j=d.outerHeight()-75,e={top:0,left:0,height:d.outerHeight(true)-15,display:"block"};d.empty().addClass("hasSPControlUploadUI").append("<div class='SPControlUploadUI spcontrolupload'><div class='mainContainer'><div class='iFrameWindow'><iframe name='SPControlUploadUI' frameborder='0' scrollbars='yes' scrolling='yes'></iframe></div><div class='buttonPane'><button type='button' class='ui-state-default' name='upload_button' value='upload' onclick='$.pt._onUpload(this);'>Upload</button></div><div class='loadingOverlay "+
c.overlayClass+"' "+i+"></div></div></div>").find(".SPControlUploadUI").data("SPControlUploadOptions",c).end().find("iframe").css("height",j).load(function(){f.pt._onIFramePageChange(d.find(".SPControlUploadUI"))}).attr("src",c.uploadPage).end().find(".loadingOverlay").append(c.overlayMessage).css(e);return this});return this};f.pt._onUpload=function(a){var c=f(a).closest(".SPControlUploadUI"),i=c.find("iframe").contents(),d=i.find("input[type='file']").closest("tr").siblings().find("span");a=c.data("SPControlUploadOptions");
var j=a.ev;d.css("display","none");if(i.find("input[type='file']").val()){j.state=2;j.action="preLoad";if(a.onPageChange)if(a.onPageChange.call(c.closest(".hasSPControlUploadUI"),j)===false)return false;c.find(".buttonPane").css("display","none").end().find(".loadingOverlay").fadeIn("slow",function(){i.find("input[type='button'][id$='btnOK']").click();if(d.is(":visible")){c.find(".loadingOverlay").css("display","none").end().find(".buttonPane").show(0).end();return false}})}};f.pt._onIFramePageChange=
function(a){var c=f(a).closest(".SPControlUploadUI"),i=c.find("iframe").contents(),d=c.data("SPControlUploadOptions"),j=d.ev;j.pageUrl=i[0].location.href;j.page=i;setTimeout(function(){if(f.pt.isSameUrlpage(f.pt.getUnEscapedUrl(j.pageUrl),f.pt.getUnEscapedUrl(d.uploadPage))||f.pt.isSameUrlpage(f.pt.getUnEscapedUrl(j.pageUrl),f.pt.getUnEscapedUrl(d.uploadPage2))){i.find("form").children(":visible").hide();i.find("form").append("<div id='SPControlUploadModUI' style='position:absolute;width:99.9%;height:99.9%x;left:0px;top:0px;background-color:white;padding-top:3em;'></div>");
if(RegExp(/error/i).test(f.trim(i.find(".ms-pagetitle").text()))||RegExp(/error/i).test(f.trim(i.find("title").text()))||RegExp(/error\.aspx/i).test(f.trim(i.find("form").attr("action")))){d._lastError=i.find("[id$='LabelMessage']").text();if(d._reloadCount>1){alert("Error encountered during upload which is causing program to loop. Last upload error was: "+d._lastError);c.find(".loadingOverlay").fadeOut();return}d._reloadCount+=1;c.find("iframe").attr("src",d.uploadPage);return}else{if(i.find("#GearPage")&&
!i.find("input[type='file']").length)return;i.find("input[type='file']").closest("table").appendTo(i.find("#SPControlUploadModUI")).removeClass("ms-authoringcontrols").find("a[id$='UploadMultipleLink']").closest("tr").css("display","none").end().end().find("input[type='checkbox'][name$='OverwriteSingle']").closest("tr").css("display","none").end().end().find(".ms-fileinput").css("font-size","13pt");if(d._lastError){i.find("input[type='file']").after('<div style="color:red;"><div class="ui-state-error">ERROR: '+
d._lastError+"</div></div>");d._lastError=""}d._reloadCount=0;d.overwrite?i.find("input[type='checkbox'][name$='OverwriteSingle']").prop("checked","checked"):i.find("input[type='checkbox'][name$='OverwriteSingle']").prop("checked","");c.find(".buttonPane").show();j.state=1;j.action="postLoad";j.hideOverlay=true}}else{j.state=3;j.action="postLoad";j.hideOverlay=true;var e=i.find("form").eq(0),b=e.prop("onsubmit");if(f.pt.isSameUrlpage(j.pageUrl,d.uploadDonePage)){j.isUploadDone=true;j.hideOverlay=
false;c.find(".loadingOverlay").empty().append('<div class="ui-state-highlight" style="width:80%;">Upload Complete!</div>')}e[0].onsubmit=function(){c.find(".loadingOverlay").css("display","block");var q=true;if(f.isFunction(d.onPageChange))q=d.onPageChange.call(c.closest(".hasSPControlUploadUI"),f.extend({},j,{state:3,action:"preLoad"}));if(q===false){c.find(".loadingOverlay").fadeOut();return q}if(f.isFunction(b))q=b();if(q===false){c.find(".loadingOverlay").fadeOut();return q}return q};f(c.find("iframe")[0].contentWindow).unload(function(){c.find(".loadingOverlay").css("display",
"block");if(f.isFunction(d.onPageChange))return d.onPageChange.call(c.closest(".hasSPControlUploadUI"),f.extend({},j,{state:3,action:"preLoad"}))})}d.onPageChange&&d.onPageChange.call(c.closest(".hasSPControlUploadUI"),j);if(j.action.toLowerCase()!="postload"||j.hideOverlay==true)c.find(".loadingOverlay").fadeOut()},500)};f.pt.isSameUrlpage=function(a,c){if(!a||!c)return false;var i=a;if(a.indexOf("?")>-1)i=a.substring(0,a.indexOf("?"));return c.indexOf(i)==0?true:false};f.pt.getEscapedUrl=escapeProperly;
f.pt.getUnEscapedUrl=unescapeProperly;f.pt.getListUID=function(a){if(!a)return"";var c="";if(f.pt._cache["getListUID:"+a])return c=f.pt._cache["getListUID:"+a];f().SPServices({operation:"GetList",listName:a,async:false,completefunc:function(i){c=f(i.responseXML).find("List").attr("ID")}});if(c)f.pt._cache["getListUID:"+a]=c;return c};f.pt.SPUploadStyleSheet="/**\n * FILE: jquery.SPControlUpload.css\n * \n * \n */\n.spcontrolupload .mainContainer {\n\tposition: relative;\n\tdisplay:block;\n}\n.spcontrolupload iframe {\n\toverflow: auto;\n\twidth: 99%;\n\theight: 99%;\n}\n.spcontrolupload iframe .ms-fileinput {\n\tfont-size:14pt;\n}\n\n.spcontrolupload .buttonPane {\n\tdisplay: none;\n}\n.spcontrolupload button {\n\tpadding: .5em;\n\tmargin: .2em;\n}\n.spcontrolupload .loadingOverlay {\n\tposition: absolute;\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: none;\n}\n.spcontrolupload .loadingOverlayMsg {\n\tmargin: auto;\n\tpadding: 5em;\n\tfont-size: 1.2em;\n}\n\n";
(function(a){var c={};c.isInitDone=false;c.templates=null;a.SPWidgets.defaults.filter={list:"",webURL:a().SPServices.SPGetCurrentSite(),columns:["Title"],textFieldTooltip:"Use a semicolon to delimiter multiple keywords.",showFilterButton:true,showFilterButtonTop:true,showStackedUI:false,filterButtonLabel:"Filter",onFilterClick:null,onReady:null,ignoreKeywords:/^(of|and|a|an|to|by|the|or|from)$/i};a.fn.SPFilterPanel=function(i){if(!c.isInitDone){c.isInitDone=true;c.styleSheet!==""&&a('<style type="text/css">\n\n'+
c.styleSheet+"\n\n</style>").prependTo("head");c.templates=a(c.htmlTemplate)}if(typeof i==="string"){if(!this.eq(0).hasClass("hasSPFilterPanel"))return;return function(d){d=d.eq(0).find("div.spwidget-filter").data("SPFilterPanelInst");var j=i.toLowerCase(),e=d.$ele;switch(j){case "getfilter":e=c.getFilterValues(d);break;case "destroy":d.$ele.removeClass("hasSPFilterPanel").empty()}return e}(this)}return this.each(function(){var d=a.extend({},a.SPWidgets.defaults.filter,i),j={$ele:a(this),$ui:null,
opt:d};j.getListDefinition=function(){return a.Deferred(function(e){a().SPServices({operation:"GetList",listName:d.list,cacheXML:true,async:true,webURL:d.webURL,completefunc:function(b,q){var s=a(b.responseXML);if(q==="error")e.rejectWith(s,[b,q]);else s.SPMsgHasError()?e.rejectWith(s,[b,q]):e.resolveWith(s,[b,q])}})}).promise()};j.buildWidget=function(){return a.Deferred(function(e){j.getListDefinition().then(function(){var b=this,q="",s=c.templates.filter("#filter_column").html();j.$ui=a(c.templates.filter("#filter_main_ui").html()).appendTo(j.$ele.empty().addClass("hasSPFilterPanel"));
j.opt.showStackedUI&&j.$ui.find("div.spwidget-filter-column-cntr").addClass("spwidget-filter-fmt-stacked");j.$list=b;a.each(j.opt.columns,function(g,k){var h=b.find("Field[DisplayName='"+k+"']"),l=s,m="",n={type:null};h.length||(h=b.find("Field[Name='"+k+"']"));if(h.length){n.Name=h.attr("Name");switch(h.attr("Type")){case "Choice":h.find("CHOICES CHOICE").each(function(p,t){m+=a.SPWidgets.fillTemplate(c.templates.filter("#filter_choice_field").html(),{DisplayName:h.attr("DisplayName"),Name:h.attr("Name"),
value:a(t).text()})});l=l.replace(/__COLUMN__UI__/,m);l=a.SPWidgets.fillTemplate(l,{DisplayName:h.attr("DisplayName"),type:"choice",Name:h.attr("Name")});break;case "Lookup":case "LookupMulti":n.type="lookup";n.list=h.attr("List");if(n.list==="Self")n.list=b.find("List").attr("Title");case "User":case "UserMulti":if(n.type===null)n.type="people";default:if(n.type===null)n.type="text";m=c.templates.filter("#filter_text_field").html();l=l.replace(/__COLUMN__UI__/,m);l=a.SPWidgets.fillTemplate(l,a.extend(n,
{DisplayName:h.attr("DisplayName"),Name:h.attr("Name"),tooltip:j.opt.textFieldTooltip}))}q+=l}});j.$ele.find("div.spwidget-filter-column-cntr").html(q);j.$ele.find("div.spwidget-type-lookup input").each(function(){var g=a(this);g.SPLookupField({list:g.data("spwidget_list"),template:'<div>{{Title}} <span class="spwidgets-item-remove">[x]</span></div>',listTemplate:"{{Title}}",allowMultiples:true,readOnly:false,filter:""});g.parent().find(".spwidget-tooltip").remove()});j.$ele.find("div.spwidget-type-people input").each(function(){var g=
a(this);g.pickSPUser({allowMultiple:true});g.parent().find(".spwidget-tooltip").remove()});j.opt.showFilterButton||j.opt.showFilterButtonTop?j.$ui.find("div.spwidget-filter-button-cntr").each(function(){var g=a(this),k=a();if(j.opt.showFilterButtonTop)k=k.add(g.clone(true)).prependTo(j.$ui);if(j.opt.showFilterButton)k=k.add(g);else g.remove();k.find("button").button({icons:{primary:"ui-icon-search"},label:j.opt.filterButtonLabel}).on("click",c.onFilterButtonClick)}):j.$ui.find("div.spwidget-filter-button-cntr").remove();
j.$ui.on("change.SPWigets.SPFilterPanel","select.spwidget-filter-type",c.onFilterTypeChange);a.isFunction(j.opt.onReady)&&j.opt.onReady.call(j.$ele,i);j.$ui.fadeIn().promise().then(function(){a(this).css("display","");e.resolve()});j.$ui.data("SPFilterPanelInst",j)}).fail(function(){j.$ele.html('<div class="ui-state-error">Unable to retrieve list information. '+this.SPGetMsgError()+"</div>");e.reject()})}).promise()};if(j.opt.ignoreKeywords&&!j.opt.ignoreKeywords instanceof RegExp)j.opt.ignoreKeywords=
/Inst.opt.ignoreKeywords/i;j.buildWidget();return this})};c.onFilterTypeChange=function(){var i=a(this),d=i.closest("div.spwidget-column").find("div.spwidget-filter-value-cntr"),j=d.find(".spwidget-input");i=i.val();if(i==="IsNull"||i==="IsNotNull"){d.addClass("spwidget-disabled");j.attr("disabled","disabled")}else{d.removeClass("spwidget-disabled");j.removeAttr("disabled","disabled")}return this};c.onFilterButtonClick=function(){var i=a(this).closest("div.spwidget-filter").data("SPFilterPanelInst"),
d=null;if(a.isFunction(i.opt.onFilterClick)){d=c.getFilterValues(i);i.opt.onFilterClick.call(i.$ele,d)}return this};c.getFilterValues=function(i){function d(b){return a.SPWidgets.getCamlLogical({type:"OR",values:b.values,onEachValue:function(q){return"<"+b.matchType+"><FieldRef Name='"+b.columnName+"' /><Value Type='Text'>"+a.SPWidgets.escapeXML(q)+"</Value></"+b.matchType+">"}})}var j={CAMLQuery:"",filters:{},count:0},e=[];i.$ui.find("div.spwidget-column").each(function(b,q){var s=a(q),g=s.find(".spwidget-input"),
k=g.attr("name"),h={columnName:k,matchType:s.find("select.spwidget-filter-type").val(),values:[],count:0,CAMLQuery:""};s=s.data("spwidget_column_type");if(h.matchType==="IsNull"||h.matchType==="IsNotNull"){h.CAMLQuery="<"+h.matchType+"><FieldRef Name='"+k+"' /></"+h.matchType+">";h.count+=1}else switch(s){case "choice":g.each(function(){var l=a(this),m=l.val();l.is(":checked")&&h.values.push(m)});if(h.values.length){h.count=h.values.length;h.CAMLQuery=d(h)}break;case "lookup":case "people":(function(){var l=
[];g.each(function(){var m=a(this);m=a.SPWidgets.parseLookupFieldValue(m.val());var n,p;n=0;for(p=m.length;n<p;n++)if(m[n].id){h.values.push(m[n].id+";#"+m[n].title);l.push(m[n].id)}});if(h.values.length){h.count=h.values.length;h.CAMLQuery=a.SPWidgets.getCamlLogical({type:"OR",values:l,onEachValue:function(m){return"<"+h.matchType+"><FieldRef Name='"+h.columnName+"' LookupId='True'/><Value Type='Lookup'>"+m+"</Value></"+h.matchType+">"}})}})();break;case "text":String(a.trim(g.val())).length&&function(){var l=
g.val().split(";"),m,n,p;m=0;for(n=l.length;m<n;m++){p=a.trim(l[m]);!i.opt.ignoreKeywords.test(p)&&p&&h.values.push(p)}h.CAMLQuery=d(h);h.count=h.values.length}()}if(h.count>0){e.push(h.CAMLQuery);j.count+=h.count;j.filters[k]=h}});if(j.count>1)j.CAMLQuery=a.SPWidgets.getCamlLogical({type:"AND",values:e});else if(j.count===1)j.CAMLQuery=e[0];return j};c.styleSheet='/** \n * Stylesheet for the Board widget\n * \n * BUILD: June 23, 2013 - 12:43 PM\n */\ndiv.spwidget-filter {\n    width: 100%;\n    position: relative;\n}\ndiv.spwidget-filter .spwidgets-lookup-cntr {\n    display: block;\n}\ndiv.spwidget-filter input[type=\'text\'],\ndiv.spwidget-filter div.spwidget-type-choice div.spwidget-filter-value-input {\n    width: 97%;\n}\ndiv.spwidget-filter div.spwidget-column {\n    padding: 1em;\n    margin: .5em;\n    position: relative;\n    border-bottom: 1px solid  darkgray;\n    box-shadow: 1px 1px 1px 0 lightgray inset;\n}\ndiv.spwidget-filter div.spwidget-filter-type-cntr {\n    margin-right: 3%;\n    float: right;\n}\ndiv.spwidget-filter div.spwidget-filter-value-cntr {\n    margin-top: .5em;\n    width: 100%;\n}\ndiv.spwidget-filter div.spwidget-column:before,\ndiv.spwidget-filter div.spwidget-column:after {\n    content: "";\n    display: table;\n    line-height: 0;\n}\ndiv.spwidget-filter div.spwidget-column:after {\n    clear: both;\n}\ndiv.spwidget-filter div.spwidget-filter-value-cntr > label {\n    display: block;\n    padding: .2em;\n    font-size: 1.1em;\n    font-weight: bold;\n}\ndiv.spwidget-filter .spwidget-tooltip {\n    display: block;\n    font-size: .8em;\n    font-style: italic;\n}\n\n\n\n/* CHOICE FIELDS */\ndiv.spwidget-filter div.spwidget-type-choice div.spwidget-filter-value-input {\n    max-height: 6em;\n    overflow: auto;\n    -moz-appearance: textfield;\n    -webkit-appearance: textfield;\n    background-color: white;\n    background-color: -moz-field;\n    border: 1px solid  darkgray;\n    box-shadow: 1px 1px 1px 0 lightgray inset;\n    font: -moz-field;\n    font: -webkit-small-control;\n    padding: 2px 5px;\n}\ndiv.spwidget-filter div.spwidget-type-choice div.spwidget-filter-value-input > label {\n    display: block;\n    padding: .2em;\n}\n\n/** DISABLED COLUMN VALUE CONTAINER */\ndiv.spwidget-filter .spwidget-disabled {\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";\n    filter: alpha(opacity=50);\n    opacity: 0.5;\n}\n\n/** Button container */\ndiv.spwidget-filter div.spwidget-filter-button-cntr {\n    padding: .5em 4%;\n    margin-top: .5em;\n    text-align: right;\n}\n\n';
c.htmlTemplate='<script type="text/html" id="filter_main_ui">\n    <div class="spwidget-filter" style="display: none;">\n        <div class="spwidget-filter-column-cntr"></div>\n        <div class="spwidget-filter-button-cntr">\n            <button type="button" class="spwidget-button">Filter</button>\n        </div>\n    </div>\n<\/script>\n<script type="text/html" id="filter_column">\n    <div class="spwidget-column spwidget-type-{{type}}" data-spwidget_column_type="{{type}}">\n        <div class="spwidget-filter-type-cntr" title="Match Type">\n            <select name="{{Name}}_type" class="spwidget-filter-type" tabindex="-1">\n                <option value="Contains" selected="selected">Contains</option>\n                <option value="Eq">Equal</option>\n                <option value="Neq">Not Equal</option>\n                <option value="IsNull">Is Blank</option> \n                <option value="IsNotNull">Is Not Blank</option> \n            </select>\n        </div>\n        <div class="spwidget-filter-value-cntr">\n            <label>{{DisplayName}}</label>\n            <div class="spwidget-filter-value-input">\n                __COLUMN__UI__\n            </div>\n        </div>\n    </div>\n<\/script>\n<script type="text/html" id="filter_text_field">\n    <input name="{{Name}}" title="{{DisplayName}}" type="text" value="" data-spwidget_list="{{list}}" class="spwidget-input" />\n    <span class="spwidget-tooltip">{{tooltip}}</span>\n<\/script>\n<script type="text/html" id="filter_choice_field">\n    <label>\n        <input name="{{Name}}" title="{{DisplayName}}" type="checkbox" value="{{value}}" class="spwidget-input" />\n        {{value}}\n    </label>\n<\/script>\n'})(f)})(jQuery);
